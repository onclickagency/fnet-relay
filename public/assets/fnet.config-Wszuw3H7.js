import{a as e,t}from"./chunk-CoEicJgV.js";var n=`modulepreload`,r=function(e){return`/`+e},i={};const a=function(e,t,a){let o=Promise.resolve();if(t&&t.length>0){let e=document.getElementsByTagName(`link`),s=document.querySelector(`meta[property=csp-nonce]`),c=s?.nonce||s?.getAttribute(`nonce`);function l(e){return Promise.all(e.map(e=>Promise.resolve(e).then(e=>({status:`fulfilled`,value:e}),e=>({status:`rejected`,reason:e}))))}o=l(t.map(t=>{if(t=r(t,a),t in i)return;i[t]=!0;let o=t.endsWith(`.css`),s=o?`[rel="stylesheet"]`:``;if(a)for(let n=e.length-1;n>=0;n--){let r=e[n];if(r.href===t&&(!o||r.rel===`stylesheet`))return}else if(document.querySelector(`link[href="${t}"]${s}`))return;let l=document.createElement(`link`);if(l.rel=o?`stylesheet`:n,o||(l.as=`script`),l.crossOrigin=``,l.href=t,c&&l.setAttribute(`nonce`,c),document.head.appendChild(l),o)return new Promise((e,n)=>{l.addEventListener(`load`,e),l.addEventListener(`error`,()=>n(Error(`Unable to preload CSS for ${t}`)))})}))}function s(e){let t=new Event(`vite:preloadError`,{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e}return o.then(t=>{for(let e of t||[])e.status===`rejected`&&s(e.reason);return e().catch(s)})};var o=e(t(((e,t)=>{(function(n,r){typeof e==`object`&&t!==void 0?t.exports=r():typeof define==`function`&&define.amd?define(r):(n=typeof globalThis<`u`?globalThis:n||self,n.Dexie=r())})(e,(function(){
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.
Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.
THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};function t(t,n){if(typeof n!=`function`&&n!==null)throw TypeError(`Class extends value `+String(n)+` is not a constructor or null`);e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}var n=function(){return n=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n],t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},n.apply(this,arguments)};function r(e,t,n){if(n||arguments.length===2)for(var r=0,i=t.length,a;r<i;r++)(a||!(r in t))&&(a||=Array.prototype.slice.call(t,0,r),a[r]=t[r]);return e.concat(a||Array.prototype.slice.call(t))}var i=typeof globalThis<`u`?globalThis:typeof self<`u`?self:typeof window<`u`?window:global,a=Object.keys,o=Array.isArray;typeof Promise<`u`&&!i.Promise&&(i.Promise=Promise);function s(e,t){return typeof t==`object`&&a(t).forEach(function(n){e[n]=t[n]}),e}var c=Object.getPrototypeOf,l={}.hasOwnProperty;function u(e,t){return l.call(e,t)}function d(e,t){typeof t==`function`&&(t=t(c(e))),(typeof Reflect>`u`?a:Reflect.ownKeys)(t).forEach(function(n){p(e,n,t[n])})}var f=Object.defineProperty;function p(e,t,n,r){f(e,t,s(n&&u(n,`get`)&&typeof n.get==`function`?{get:n.get,set:n.set,configurable:!0}:{value:n,configurable:!0,writable:!0},r))}function m(e){return{from:function(t){return e.prototype=Object.create(t.prototype),p(e.prototype,`constructor`,e),{extend:d.bind(null,e.prototype)}}}}var h=Object.getOwnPropertyDescriptor;function g(e,t){var n=h(e,t),r;return n||(r=c(e))&&g(r,t)}var _=[].slice;function v(e,t,n){return _.call(e,t,n)}function y(e,t){return t(e)}function b(e){if(!e)throw Error(`Assertion Failed`)}function x(e){i.setImmediate?setImmediate(e):setTimeout(e,0)}function S(e,t){return e.reduce(function(e,n,r){var i=t(n,r);return i&&(e[i[0]]=i[1]),e},{})}function C(e,t){if(typeof t==`string`&&u(e,t))return e[t];if(!t)return e;if(typeof t!=`string`){for(var n=[],r=0,i=t.length;r<i;++r){var a=C(e,t[r]);n.push(a)}return n}var o=t.indexOf(`.`);if(o!==-1){var s=e[t.substr(0,o)];return s==null?void 0:C(s,t.substr(o+1))}}function w(e,t,n){if(!(!e||t===void 0)&&!(`isFrozen`in Object&&Object.isFrozen(e)))if(typeof t!=`string`&&`length`in t){b(typeof n!=`string`&&`length`in n);for(var r=0,i=t.length;r<i;++r)w(e,t[r],n[r])}else{var a=t.indexOf(`.`);if(a!==-1){var s=t.substr(0,a),c=t.substr(a+1);if(c===``)n===void 0?o(e)&&!isNaN(parseInt(s))?e.splice(s,1):delete e[s]:e[s]=n;else{var l=e[s];(!l||!u(e,s))&&(l=e[s]={}),w(l,c,n)}}else n===void 0?o(e)&&!isNaN(parseInt(t))?e.splice(t,1):delete e[t]:e[t]=n}}function ee(e,t){typeof t==`string`?w(e,t,void 0):`length`in t&&[].map.call(t,function(t){w(e,t,void 0)})}function te(e){var t={};for(var n in e)u(e,n)&&(t[n]=e[n]);return t}var ne=[].concat;function re(e){return ne.apply([],e)}var ie=`BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey`.split(`,`).concat(re([8,16,32,64].map(function(e){return[`Int`,`Uint`,`Float`].map(function(t){return t+e+`Array`})}))).filter(function(e){return i[e]}),ae=new Set(ie.map(function(e){return i[e]}));function oe(e){var t={};for(var n in e)if(u(e,n)){var r=e[n];t[n]=!r||typeof r!=`object`||ae.has(r.constructor)?r:oe(r)}return t}function se(e){for(var t in e)if(u(e,t))return!1;return!0}var ce=null;function T(e){ce=new WeakMap;var t=le(e);return ce=null,t}function le(e){if(!e||typeof e!=`object`)return e;var t=ce.get(e);if(t)return t;if(o(e)){t=[],ce.set(e,t);for(var n=0,r=e.length;n<r;++n)t.push(le(e[n]))}else if(ae.has(e.constructor))t=e;else{var i=c(e);for(var a in t=i===Object.prototype?{}:Object.create(i),ce.set(e,t),e)u(e,a)&&(t[a]=le(e[a]))}return t}var ue={}.toString;function de(e){return ue.call(e).slice(8,-1)}var fe=typeof Symbol<`u`?Symbol.iterator:`@@iterator`,pe=typeof fe==`symbol`?function(e){var t;return e!=null&&(t=e[fe])&&t.apply(e)}:function(){return null};function me(e,t){var n=e.indexOf(t);return n>=0&&e.splice(n,1),n>=0}var he={};function E(e){var t,n,r,i;if(arguments.length===1){if(o(e))return e.slice();if(this===he&&typeof e==`string`)return[e];if(i=pe(e)){for(n=[];r=i.next(),!r.done;)n.push(r.value);return n}if(e==null)return[e];if(t=e.length,typeof t==`number`){for(n=Array(t);t--;)n[t]=e[t];return n}return[e]}for(t=arguments.length,n=Array(t);t--;)n[t]=arguments[t];return n}var ge=typeof Symbol<`u`?function(e){return e[Symbol.toStringTag]===`AsyncFunction`}:function(){return!1},_e=[`Modify`,`Bulk`,`OpenFailed`,`VersionChange`,`Schema`,`Upgrade`,`InvalidTable`,`MissingAPI`,`NoSuchDatabase`,`InvalidArgument`,`SubTransaction`,`Unsupported`,`Internal`,`DatabaseClosed`,`PrematureCommit`,`ForeignAwait`],ve=[`Unknown`,`Constraint`,`Data`,`TransactionInactive`,`ReadOnly`,`Version`,`NotFound`,`InvalidState`,`InvalidAccess`,`Abort`,`Timeout`,`QuotaExceeded`,`Syntax`,`DataClone`],ye=_e.concat(ve),be={VersionChanged:`Database version changed by other database connection`,DatabaseClosed:`Database has been closed`,Abort:`Transaction aborted`,TransactionInactive:`Transaction has already completed or failed`,MissingAPI:`IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb`};function xe(e,t){this.name=e,this.message=t}m(xe).from(Error).extend({toString:function(){return this.name+`: `+this.message}});function Se(e,t){return e+`. Errors: `+Object.keys(t).map(function(e){return t[e].toString()}).filter(function(e,t,n){return n.indexOf(e)===t}).join(`
`)}function Ce(e,t,n,r){this.failures=t,this.failedKeys=r,this.successCount=n,this.message=Se(e,t)}m(Ce).from(xe);function we(e,t){this.name=`BulkError`,this.failures=Object.keys(t).map(function(e){return t[e]}),this.failuresByPos=t,this.message=Se(e,this.failures)}m(we).from(xe);var Te=ye.reduce(function(e,t){return e[t]=t+`Error`,e},{}),Ee=xe,D=ye.reduce(function(e,t){var n=t+`Error`;function r(e,r){this.name=n,e?typeof e==`string`?(this.message=`${e}${r?`
 `+r:``}`,this.inner=r||null):typeof e==`object`&&(this.message=`${e.name} ${e.message}`,this.inner=e):(this.message=be[t]||n,this.inner=null)}return m(r).from(Ee),e[t]=r,e},{});D.Syntax=SyntaxError,D.Type=TypeError,D.Range=RangeError;var De=ve.reduce(function(e,t){return e[t+`Error`]=D[t],e},{});function Oe(e,t){if(!e||e instanceof xe||e instanceof TypeError||e instanceof SyntaxError||!e.name||!De[e.name])return e;var n=new De[e.name](t||e.message,e);return`stack`in e&&p(n,`stack`,{get:function(){return this.inner.stack}}),n}var ke=ye.reduce(function(e,t){return[`Syntax`,`Type`,`Range`].indexOf(t)===-1&&(e[t+`Error`]=D[t]),e},{});ke.ModifyError=Ce,ke.DexieError=xe,ke.BulkError=we;function O(){}function Ae(e){return e}function je(e,t){return e==null||e===Ae?t:function(n){return t(e(n))}}function k(e,t){return function(){e.apply(this,arguments),t.apply(this,arguments)}}function Me(e,t){return e===O?t:function(){var n=e.apply(this,arguments);n!==void 0&&(arguments[0]=n);var r=this.onsuccess,i=this.onerror;this.onsuccess=null,this.onerror=null;var a=t.apply(this,arguments);return r&&(this.onsuccess=this.onsuccess?k(r,this.onsuccess):r),i&&(this.onerror=this.onerror?k(i,this.onerror):i),a===void 0?n:a}}function Ne(e,t){return e===O?t:function(){e.apply(this,arguments);var n=this.onsuccess,r=this.onerror;this.onsuccess=this.onerror=null,t.apply(this,arguments),n&&(this.onsuccess=this.onsuccess?k(n,this.onsuccess):n),r&&(this.onerror=this.onerror?k(r,this.onerror):r)}}function Pe(e,t){return e===O?t:function(n){var r=e.apply(this,arguments);s(n,r);var i=this.onsuccess,a=this.onerror;this.onsuccess=null,this.onerror=null;var o=t.apply(this,arguments);return i&&(this.onsuccess=this.onsuccess?k(i,this.onsuccess):i),a&&(this.onerror=this.onerror?k(a,this.onerror):a),r===void 0?o===void 0?void 0:o:s(r,o)}}function Fe(e,t){return e===O?t:function(){return t.apply(this,arguments)===!1?!1:e.apply(this,arguments)}}function Ie(e,t){return e===O?t:function(){var n=e.apply(this,arguments);if(n&&typeof n.then==`function`){for(var r=this,i=arguments.length,a=Array(i);i--;)a[i]=arguments[i];return n.then(function(){return t.apply(r,a)})}return t.apply(this,arguments)}}var A=typeof location<`u`&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function Le(e,t){A=e}var Re={},ze=100,Be=typeof Promise>`u`?[]:(function(){var e=Promise.resolve();if(typeof crypto>`u`||!crypto.subtle)return[e,c(e),e];var t=crypto.subtle.digest(`SHA-512`,new Uint8Array([0]));return[t,c(t),e]})(),Ve=Be[0],He=Be[1],Ue=Be[2],We=He&&He.then,j=Ve&&Ve.constructor,Ge=!!Ue;function Ke(){queueMicrotask(ct)}var qe=function(e,t){$e.push([e,t]),Ye&&=(Ke(),!1)},Je=!0,Ye=!0,Xe=[],Ze=[],Qe=Ae,M={id:`global`,global:!0,ref:0,unhandleds:[],onunhandled:O,pgp:!1,env:{},finalize:O},N=M,$e=[],P=0,et=[];function F(e){if(typeof this!=`object`)throw TypeError(`Promises must be constructed via new`);this._listeners=[],this._lib=!1;var t=this._PSD=N;if(typeof e!=`function`){if(e!==Re)throw TypeError(`Not a function`);this._state=arguments[1],this._value=arguments[2],this._state===!1&&it(this,this._value);return}this._state=null,this._value=null,++t.ref,rt(this,e)}var tt={get:function(){var e=N,t=yt;function n(n,r){var i=this,a=!e.global&&(e!==N||t!==yt),o=a&&!z(),s=new F(function(t,s){ot(i,new nt(Et(n,e,a,o),Et(r,e,a,o),t,s,e))});return this._consoleTask&&(s._consoleTask=this._consoleTask),s}return n.prototype=Re,n},set:function(e){p(this,`then`,e&&e.prototype===Re?tt:{get:function(){return e},set:tt.set})}};d(F.prototype,{then:tt,_then:function(e,t){ot(this,new nt(null,null,e,t,N))},catch:function(e){if(arguments.length===1)return this.then(null,e);var t=arguments[0],n=arguments[1];return typeof t==`function`?this.then(null,function(e){return e instanceof t?n(e):ht(e)}):this.then(null,function(e){return e&&e.name===t?n(e):ht(e)})},finally:function(e){return this.then(function(t){return F.resolve(e()).then(function(){return t})},function(t){return F.resolve(e()).then(function(){return ht(t)})})},timeout:function(e,t){var n=this;return e<1/0?new F(function(r,i){var a=setTimeout(function(){return i(new D.Timeout(t))},e);n.then(r,i).finally(clearTimeout.bind(null,a))}):this}}),typeof Symbol<`u`&&Symbol.toStringTag&&p(F.prototype,Symbol.toStringTag,`Dexie.Promise`),M.env=Tt();function nt(e,t,n,r,i){this.onFulfilled=typeof e==`function`?e:null,this.onRejected=typeof t==`function`?t:null,this.resolve=n,this.reject=r,this.psd=i}d(F,{all:function(){var e=E.apply(null,arguments).map(St);return new F(function(t,n){e.length===0&&t([]);var r=e.length;e.forEach(function(i,a){return F.resolve(i).then(function(n){e[a]=n,--r||t(e)},n)})})},resolve:function(e){return e instanceof F?e:e&&typeof e.then==`function`?new F(function(t,n){e.then(t,n)}):new F(Re,!0,e)},reject:ht,race:function(){var e=E.apply(null,arguments).map(St);return new F(function(t,n){e.map(function(e){return F.resolve(e).then(t,n)})})},PSD:{get:function(){return N},set:function(e){return N=e}},totalEchoes:{get:function(){return yt}},newPSD:R,usePSD:V,scheduler:{get:function(){return qe},set:function(e){qe=e}},rejectionMapper:{get:function(){return Qe},set:function(e){Qe=e}},follow:function(e,t){return new F(function(n,r){return R(function(t,n){var r=N;r.unhandleds=[],r.onunhandled=n,r.finalize=k(function(){var e=this;ft(function(){e.unhandleds.length===0?t():n(e.unhandleds[0])})},r.finalize),e()},t,n,r)})}}),j&&(j.allSettled&&p(F,`allSettled`,function(){var e=E.apply(null,arguments).map(St);return new F(function(t){e.length===0&&t([]);var n=e.length,r=Array(n);e.forEach(function(e,i){return F.resolve(e).then(function(e){return r[i]={status:`fulfilled`,value:e}},function(e){return r[i]={status:`rejected`,reason:e}}).then(function(){return--n||t(r)})})})}),j.any&&typeof AggregateError<`u`&&p(F,`any`,function(){var e=E.apply(null,arguments).map(St);return new F(function(t,n){e.length===0&&n(AggregateError([]));var r=e.length,i=Array(r);e.forEach(function(e,a){return F.resolve(e).then(function(e){return t(e)},function(e){i[a]=e,--r||n(AggregateError(i))})})})}),j.withResolvers&&(F.withResolvers=j.withResolvers));function rt(e,t){try{t(function(t){if(e._state===null){if(t===e)throw TypeError(`A promise cannot be resolved with itself.`);var n=e._lib&&lt();t&&typeof t.then==`function`?rt(e,function(e,n){t instanceof F?t._then(e,n):t.then(e,n)}):(e._state=!0,e._value=t,at(e)),n&&ut()}},it.bind(null,e))}catch(t){it(e,t)}}function it(e,t){if(Ze.push(t),e._state===null){var n=e._lib&&lt();t=Qe(t),e._state=!1,e._value=t,pt(e),at(e),n&&ut()}}function at(e){var t=e._listeners;e._listeners=[];for(var n=0,r=t.length;n<r;++n)ot(e,t[n]);var i=e._PSD;--i.ref||i.finalize(),P===0&&(++P,qe(function(){--P===0&&dt()},[]))}function ot(e,t){if(e._state===null){e._listeners.push(t);return}var n=e._state?t.onFulfilled:t.onRejected;if(n===null)return(e._state?t.resolve:t.reject)(e._value);++t.psd.ref,++P,qe(st,[n,e,t])}function st(e,t,n){try{var r,i=t._value;!t._state&&Ze.length&&(Ze=[]),r=A&&t._consoleTask?t._consoleTask.run(function(){return e(i)}):e(i),!t._state&&Ze.indexOf(i)===-1&&mt(t),n.resolve(r)}catch(e){n.reject(e)}finally{--P===0&&dt(),--n.psd.ref||n.psd.finalize()}}function ct(){V(M,function(){lt()&&ut()})}function lt(){var e=Je;return Je=!1,Ye=!1,e}function ut(){var e,t,n;do for(;$e.length>0;)for(e=$e,$e=[],n=e.length,t=0;t<n;++t){var r=e[t];r[0].apply(null,r[1])}while($e.length>0);Je=!0,Ye=!0}function dt(){var e=Xe;Xe=[],e.forEach(function(e){e._PSD.onunhandled.call(null,e._value,e)});for(var t=et.slice(0),n=t.length;n;)t[--n]()}function ft(e){function t(){e(),et.splice(et.indexOf(t),1)}et.push(t),++P,qe(function(){--P===0&&dt()},[])}function pt(e){Xe.some(function(t){return t._value===e._value})||Xe.push(e)}function mt(e){for(var t=Xe.length;t;)if(Xe[--t]._value===e._value){Xe.splice(t,1);return}}function ht(e){return new F(Re,!1,e)}function I(e,t){var n=N;return function(){var r=lt(),i=N;try{return B(n,!0),e.apply(this,arguments)}catch(e){t&&t(e)}finally{B(i,!1),r&&ut()}}}var L={awaits:0,echoes:0,id:0},gt=0,_t=[],vt=0,yt=0,bt=0;function R(e,t,n,r){var i=N,a=Object.create(i);a.parent=i,a.ref=0,a.global=!1,a.id=++bt,M.env,a.env=Ge?{Promise:F,PromiseProp:{value:F,configurable:!0,writable:!0},all:F.all,race:F.race,allSettled:F.allSettled,any:F.any,resolve:F.resolve,reject:F.reject}:{},t&&s(a,t),++i.ref,a.finalize=function(){--this.parent.ref||this.parent.finalize()};var o=V(a,e,n,r);return a.ref===0&&a.finalize(),o}function xt(){return L.id||=++gt,++L.awaits,L.echoes+=ze,L.id}function z(){return L.awaits?(--L.awaits===0&&(L.id=0),L.echoes=L.awaits*ze,!0):!1}(``+We).indexOf(`[native code]`)===-1&&(xt=z=O);function St(e){return L.echoes&&e&&e.constructor===j?(xt(),e.then(function(e){return z(),e},function(e){return z(),H(e)})):e}function Ct(e){++yt,(!L.echoes||--L.echoes===0)&&(L.echoes=L.awaits=L.id=0),_t.push(N),B(e,!0)}function wt(){var e=_t[_t.length-1];_t.pop(),B(e,!1)}function B(e,t){var n=N;if((t?L.echoes&&(!vt++||e!==N):vt&&(!--vt||e!==N))&&queueMicrotask(t?Ct.bind(null,e):wt),e!==N&&(N=e,n===M&&(M.env=Tt()),Ge)){var r=M.env.Promise,a=e.env;(n.global||e.global)&&(Object.defineProperty(i,`Promise`,a.PromiseProp),r.all=a.all,r.race=a.race,r.resolve=a.resolve,r.reject=a.reject,a.allSettled&&(r.allSettled=a.allSettled),a.any&&(r.any=a.any))}}function Tt(){var e=i.Promise;return Ge?{Promise:e,PromiseProp:Object.getOwnPropertyDescriptor(i,`Promise`),all:e.all,race:e.race,allSettled:e.allSettled,any:e.any,resolve:e.resolve,reject:e.reject}:{}}function V(e,t,n,r,i){var a=N;try{return B(e,!0),t(n,r,i)}finally{B(a,!1)}}function Et(e,t,n,r){return typeof e==`function`?function(){var i=N;n&&xt(),B(t,!0);try{return e.apply(this,arguments)}finally{B(i,!1),r&&queueMicrotask(z)}}:e}function Dt(e){Promise===j&&L.echoes===0?vt===0?e():enqueueNativeMicroTask(e):setTimeout(e,0)}var H=F.reject;function Ot(e,t,n,r){if(!e.idbdb||!e._state.openComplete&&!N.letThrough&&!e._vip){if(e._state.openComplete)return H(new D.DatabaseClosed(e._state.dbOpenError));if(!e._state.isBeingOpened){if(!e._state.autoOpen)return H(new D.DatabaseClosed);e.open().catch(O)}return e._state.dbReadyPromise.then(function(){return Ot(e,t,n,r)})}else{var i=e._createTransaction(t,n,e._dbSchema);try{i.create(),e._state.PR1398_maxLoop=3}catch(i){return i.name===Te.InvalidState&&e.isOpen()&&--e._state.PR1398_maxLoop>0?(console.warn(`Dexie: Need to reopen db`),e.close({disableAutoOpen:!1}),e.open().then(function(){return Ot(e,t,n,r)})):H(i)}return i._promise(t,function(e,t){return R(function(){return N.trans=i,r(e,t,i)})}).then(function(e){if(t===`readwrite`)try{i.idbtrans.commit()}catch{}return t===`readonly`?e:i._completion.then(function(){return e})})}}var kt=`4.2.1`,U=`ï¿¿`,At=-1/0,W=`Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.`,jt=`String expected.`,Mt=[],Nt=`__dbnames`,Pt=`readonly`,Ft=`readwrite`;function G(e,t){return e?t?function(){return e.apply(this,arguments)&&t.apply(this,arguments)}:e:t}var It={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function Lt(e){return typeof e==`string`&&!/\./.test(e)?function(t){return t[e]===void 0&&e in t&&(t=T(t),delete t[e]),t}:function(e){return e}}function Rt(){throw D.Type(`Entity instances must never be new:ed. Instances are generated by the framework bypassing the constructor.`)}function K(e,t){try{var n=Vt(e),r=Vt(t);if(n!==r)return n===`Array`?1:r===`Array`?-1:n===`binary`?1:r===`binary`?-1:n===`string`?1:r===`string`?-1:n===`Date`?1:r===`Date`?-1:NaN;switch(n){case`number`:case`Date`:case`string`:return e>t?1:e<t?-1:0;case`binary`:return Bt(Ht(e),Ht(t));case`Array`:return zt(e,t)}}catch{}return NaN}function zt(e,t){for(var n=e.length,r=t.length,i=n<r?n:r,a=0;a<i;++a){var o=K(e[a],t[a]);if(o!==0)return o}return n===r?0:n<r?-1:1}function Bt(e,t){for(var n=e.length,r=t.length,i=n<r?n:r,a=0;a<i;++a)if(e[a]!==t[a])return e[a]<t[a]?-1:1;return n===r?0:n<r?-1:1}function Vt(e){var t=typeof e;if(t!==`object`)return t;if(ArrayBuffer.isView(e))return`binary`;var n=de(e);return n===`ArrayBuffer`?`binary`:n}function Ht(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e)}function Ut(e,t,n){var r=e.schema.yProps;return r?(t&&n.numFailures>0&&(t=t.filter(function(e,t){return!n.failures[t]})),Promise.all(r.map(function(n){var r=n.updatesTable;return t?e.db.table(r).where(`k`).anyOf(t).delete():e.db.table(r).clear()})).then(function(){return n})):n}var Wt=function(){function e(e){this[`@@propmod`]=e}return e.prototype.execute=function(e){var t=this[`@@propmod`];if(t.add!==void 0){var n=t.add;if(o(n))return r(r([],o(e)?e:[],!0),n,!0).sort();if(typeof n==`number`)return(Number(e)||0)+n;if(typeof n==`bigint`)try{return BigInt(e)+n}catch{return BigInt(0)+n}throw TypeError(`Invalid term ${n}`)}if(t.remove!==void 0){var i=t.remove;if(o(i))return o(e)?e.filter(function(e){return!i.includes(e)}).sort():[];if(typeof i==`number`)return Number(e)-i;if(typeof i==`bigint`)try{return BigInt(e)-i}catch{return BigInt(0)-i}throw TypeError(`Invalid subtrahend ${i}`)}var a=t.replacePrefix?.[0];return a&&typeof e==`string`&&e.startsWith(a)?t.replacePrefix[1]+e.substring(a.length):e},e}();function Gt(e,t){for(var n=a(t),r=n.length,i=!1,o=0;o<r;++o){var s=n[o],c=t[s],l=C(e,s);c instanceof Wt?(w(e,s,c.execute(l)),i=!0):l!==c&&(w(e,s,c),i=!0)}return i}var Kt=function(){function e(){}return e.prototype._trans=function(e,t,n){var r=this._tx||N.trans,i=this.name,a=A&&typeof console<`u`&&console.createTask&&console.createTask(`Dexie: ${e===`readonly`?`read`:`write`} ${this.name}`);function o(e,n,r){if(!r.schema[i])throw new D.NotFound(`Table `+i+` not part of transaction`);return t(r.idbtrans,r)}var s=lt();try{var c=r&&r.db._novip===this.db._novip?r===N.trans?r._promise(e,o,n):R(function(){return r._promise(e,o,n)},{trans:r,transless:N.transless||N}):Ot(this.db,e,[this.name],o);return a&&(c._consoleTask=a,c=c.catch(function(e){return console.trace(e),H(e)})),c}finally{s&&ut()}},e.prototype.get=function(e,t){var n=this;return e&&e.constructor===Object?this.where(e).first(t):e==null?H(new D.Type(`Invalid argument to Table.get()`)):this._trans(`readonly`,function(t){return n.core.get({trans:t,key:e}).then(function(e){return n.hook.reading.fire(e)})}).then(t)},e.prototype.where=function(e){if(typeof e==`string`)return new this.db.WhereClause(this,e);if(o(e))return new this.db.WhereClause(this,`[${e.join(`+`)}]`);var t=a(e);if(t.length===1)return this.where(t[0]).equals(e[t[0]]);var n=this.schema.indexes.concat(this.schema.primKey).filter(function(e){if(e.compound&&t.every(function(t){return e.keyPath.indexOf(t)>=0})){for(var n=0;n<t.length;++n)if(t.indexOf(e.keyPath[n])===-1)return!1;return!0}return!1}).sort(function(e,t){return e.keyPath.length-t.keyPath.length})[0];if(n&&this.db._maxKey!==U){var r=n.keyPath.slice(0,t.length);return this.where(r).equals(r.map(function(t){return e[t]}))}!n&&A&&console.warn(`The query ${JSON.stringify(e)} on ${this.name} would benefit from a compound index [${t.join(`+`)}]`);var i=this.schema.idxByName;function s(e,t){return K(e,t)===0}var c=t.reduce(function(t,n){var r=t[0],a=t[1],c=i[n],l=e[n];return[r||c,r||!c?G(a,c&&c.multi?function(e){var t=C(e,n);return o(t)&&t.some(function(e){return s(l,e)})}:function(e){return s(l,C(e,n))}):a]},[null,null]),l=c[0],u=c[1];return l?this.where(l.name).equals(e[l.keyPath]).filter(u):n?this.filter(u):this.where(t).equals(``)},e.prototype.filter=function(e){return this.toCollection().and(e)},e.prototype.count=function(e){return this.toCollection().count(e)},e.prototype.offset=function(e){return this.toCollection().offset(e)},e.prototype.limit=function(e){return this.toCollection().limit(e)},e.prototype.each=function(e){return this.toCollection().each(e)},e.prototype.toArray=function(e){return this.toCollection().toArray(e)},e.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},e.prototype.orderBy=function(e){return new this.db.Collection(new this.db.WhereClause(this,o(e)?`[${e.join(`+`)}]`:e))},e.prototype.reverse=function(){return this.toCollection().reverse()},e.prototype.mapToClass=function(e){var n=this,r=n.db,i=n.name;this.schema.mappedClass=e,e.prototype instanceof Rt&&(e=function(e){t(n,e);function n(){return e!==null&&e.apply(this,arguments)||this}return Object.defineProperty(n.prototype,`db`,{get:function(){return r},enumerable:!1,configurable:!0}),n.prototype.table=function(){return i},n}(e));for(var a=new Set,o=e.prototype;o;o=c(o))Object.getOwnPropertyNames(o).forEach(function(e){return a.add(e)});var s=function(t){if(!t)return t;var n=Object.create(e.prototype);for(var r in t)if(!a.has(r))try{n[r]=t[r]}catch{}return n};return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=s,this.hook(`reading`,s),e},e.prototype.defineClass=function(){function e(e){s(this,e)}return this.mapToClass(e)},e.prototype.add=function(e,t){var n=this,r=this.schema.primKey,i=r.auto,a=r.keyPath,o=e;return a&&i&&(o=Lt(a)(e)),this._trans(`readwrite`,function(e){return n.core.mutate({trans:e,type:`add`,keys:t==null?null:[t],values:[o]})}).then(function(e){return e.numFailures?F.reject(e.failures[0]):e.lastResult}).then(function(t){if(a)try{w(e,a,t)}catch{}return t})},e.prototype.upsert=function(e,t){var n=this,r=this.schema.primKey.keyPath;return this._trans(`readwrite`,function(i){return n.core.get({trans:i,key:e}).then(function(a){var o=a??{};return Gt(o,t),r&&w(o,r,e),n.core.mutate({trans:i,type:`put`,values:[o],keys:[e],upsert:!0,updates:{keys:[e],changeSpecs:[t]}}).then(function(e){return e.numFailures?F.reject(e.failures[0]):!!a})})})},e.prototype.update=function(e,t){if(typeof e==`object`&&!o(e)){var n=C(e,this.schema.primKey.keyPath);return n===void 0?H(new D.InvalidArgument(`Given object does not contain its primary key`)):this.where(`:id`).equals(n).modify(t)}else return this.where(`:id`).equals(e).modify(t)},e.prototype.put=function(e,t){var n=this,r=this.schema.primKey,i=r.auto,a=r.keyPath,o=e;return a&&i&&(o=Lt(a)(e)),this._trans(`readwrite`,function(e){return n.core.mutate({trans:e,type:`put`,values:[o],keys:t==null?null:[t]})}).then(function(e){return e.numFailures?F.reject(e.failures[0]):e.lastResult}).then(function(t){if(a)try{w(e,a,t)}catch{}return t})},e.prototype.delete=function(e){var t=this;return this._trans(`readwrite`,function(n){return t.core.mutate({trans:n,type:`delete`,keys:[e]}).then(function(n){return Ut(t,[e],n)}).then(function(e){return e.numFailures?F.reject(e.failures[0]):void 0})})},e.prototype.clear=function(){var e=this;return this._trans(`readwrite`,function(t){return e.core.mutate({trans:t,type:`deleteRange`,range:It}).then(function(t){return Ut(e,null,t)})}).then(function(e){return e.numFailures?F.reject(e.failures[0]):void 0})},e.prototype.bulkGet=function(e){var t=this;return this._trans(`readonly`,function(n){return t.core.getMany({keys:e,trans:n}).then(function(e){return e.map(function(e){return t.hook.reading.fire(e)})})})},e.prototype.bulkAdd=function(e,t,n){var r=this,i=Array.isArray(t)?t:void 0;n||=i?void 0:t;var a=n?n.allKeys:void 0;return this._trans(`readwrite`,function(t){var n=r.schema.primKey,o=n.auto,s=n.keyPath;if(s&&i)throw new D.InvalidArgument(`bulkAdd(): keys argument invalid on tables with inbound keys`);if(i&&i.length!==e.length)throw new D.InvalidArgument(`Arguments objects and keys must have the same length`);var c=e.length,l=s&&o?e.map(Lt(s)):e;return r.core.mutate({trans:t,type:`add`,keys:i,values:l,wantResults:a}).then(function(e){var t=e.numFailures,n=e.results,i=e.lastResult,o=e.failures,s=a?n:i;if(t===0)return s;throw new we(`${r.name}.bulkAdd(): ${t} of ${c} operations failed`,o)})})},e.prototype.bulkPut=function(e,t,n){var r=this,i=Array.isArray(t)?t:void 0;n||=i?void 0:t;var a=n?n.allKeys:void 0;return this._trans(`readwrite`,function(t){var n=r.schema.primKey,o=n.auto,s=n.keyPath;if(s&&i)throw new D.InvalidArgument(`bulkPut(): keys argument invalid on tables with inbound keys`);if(i&&i.length!==e.length)throw new D.InvalidArgument(`Arguments objects and keys must have the same length`);var c=e.length,l=s&&o?e.map(Lt(s)):e;return r.core.mutate({trans:t,type:`put`,keys:i,values:l,wantResults:a}).then(function(e){var t=e.numFailures,n=e.results,i=e.lastResult,o=e.failures,s=a?n:i;if(t===0)return s;throw new we(`${r.name}.bulkPut(): ${t} of ${c} operations failed`,o)})})},e.prototype.bulkUpdate=function(e){var t=this,n=this.core,r=e.map(function(e){return e.key}),i=e.map(function(e){return e.changes}),a=[];return this._trans(`readwrite`,function(o){return n.getMany({trans:o,keys:r,cache:`clone`}).then(function(s){var c=[],l=[];e.forEach(function(e,n){var r=e.key,i=e.changes,o=s[n];if(o){for(var u=0,d=Object.keys(i);u<d.length;u++){var f=d[u],p=i[f];if(f===t.schema.primKey.keyPath){if(K(p,r)!==0)throw new D.Constraint(`Cannot update primary key in bulkUpdate()`)}else w(o,f,p)}a.push(n),c.push(r),l.push(o)}});var u=c.length;return n.mutate({trans:o,type:`put`,keys:c,values:l,updates:{keys:r,changeSpecs:i}}).then(function(e){var n=e.numFailures,r=e.failures;if(n===0)return u;for(var i=0,o=Object.keys(r);i<o.length;i++){var s=o[i],c=a[Number(s)];if(c!=null){var l=r[s];delete r[s],r[c]=l}}throw new we(`${t.name}.bulkUpdate(): ${n} of ${u} operations failed`,r)})})})},e.prototype.bulkDelete=function(e){var t=this,n=e.length;return this._trans(`readwrite`,function(n){return t.core.mutate({trans:n,type:`delete`,keys:e}).then(function(n){return Ut(t,e,n)})}).then(function(e){var r=e.numFailures,i=e.lastResult,a=e.failures;if(r===0)return i;throw new we(`${t.name}.bulkDelete(): ${r} of ${n} operations failed`,a)})},e}();function qt(e){var t={},n=function(n,r){if(r){for(var i=arguments.length,a=Array(i-1);--i;)a[i-1]=arguments[i];return t[n].subscribe.apply(null,a),e}else if(typeof n==`string`)return t[n]};n.addEventType=s;for(var r=1,i=arguments.length;r<i;++r)s(arguments[r]);return n;function s(e,r,i){if(typeof e==`object`)return c(e);r||=Fe,i||=O;var a={subscribers:[],fire:i,subscribe:function(e){a.subscribers.indexOf(e)===-1&&(a.subscribers.push(e),a.fire=r(a.fire,e))},unsubscribe:function(e){a.subscribers=a.subscribers.filter(function(t){return t!==e}),a.fire=a.subscribers.reduce(r,i)}};return t[e]=n[e]=a,a}function c(e){a(e).forEach(function(t){var n=e[t];if(o(n))s(t,e[t][0],e[t][1]);else if(n===`asap`)var r=s(t,Ae,function(){for(var e=arguments.length,t=Array(e);e--;)t[e]=arguments[e];r.subscribers.forEach(function(e){x(function(){e.apply(null,t)})})});else throw new D.InvalidArgument(`Invalid event config`)})}}function Jt(e,t){return m(t).from({prototype:e}),t}function Yt(e){return Jt(Kt.prototype,function(t,n,r){this.db=e,this._tx=r,this.name=t,this.schema=n,this.hook=e._allTables[t]?e._allTables[t].hook:qt(null,{creating:[Me,O],reading:[je,Ae],updating:[Pe,O],deleting:[Ne,O]})})}function Xt(e,t){return!(e.filter||e.algorithm||e.or)&&(t?e.justLimit:!e.replayFilter)}function Zt(e,t){e.filter=G(e.filter,t)}function Qt(e,t,n){var r=e.replayFilter;e.replayFilter=r?function(){return G(r(),t())}:t,e.justLimit=n&&!r}function $t(e,t){e.isMatch=G(e.isMatch,t)}function en(e,t){if(e.isPrimKey)return t.primaryKey;var n=t.getIndexByKeyPath(e.index);if(!n)throw new D.Schema(`KeyPath `+e.index+` on object store `+t.name+` is not indexed`);return n}function tn(e,t,n){var r=en(e,t.schema);return t.openCursor({trans:n,values:!e.keysOnly,reverse:e.dir===`prev`,unique:!!e.unique,query:{index:r,range:e.range}})}function nn(e,t,n,r){var i=e.replayFilter?G(e.filter,e.replayFilter()):e.filter;if(e.or){var a={},o=function(e,n,r){if(!i||i(n,r,function(e){return n.stop(e)},function(e){return n.fail(e)})){var o=n.primaryKey,s=``+o;s===`[object ArrayBuffer]`&&(s=``+new Uint8Array(o)),u(a,s)||(a[s]=!0,t(e,n,r))}};return Promise.all([e.or._iterate(o,n),rn(tn(e,r,n),e.algorithm,o,!e.keysOnly&&e.valueMapper)])}else return rn(tn(e,r,n),G(e.algorithm,i),t,!e.keysOnly&&e.valueMapper)}function rn(e,t,n,r){var i=I(r?function(e,t,i){return n(r(e),t,i)}:n);return e.then(function(e){if(e)return e.start(function(){var n=function(){return e.continue()};(!t||t(e,function(e){return n=e},function(t){e.stop(t),n=O},function(t){e.fail(t),n=O}))&&i(e.value,e,function(e){return n=e}),n()})})}var an=function(){function e(){}return e.prototype._read=function(e,t){var n=this._ctx;return n.error?n.table._trans(null,H.bind(null,n.error)):n.table._trans(`readonly`,e).then(t)},e.prototype._write=function(e){var t=this._ctx;return t.error?t.table._trans(null,H.bind(null,t.error)):t.table._trans(`readwrite`,e,`locked`)},e.prototype._addAlgorithm=function(e){var t=this._ctx;t.algorithm=G(t.algorithm,e)},e.prototype._iterate=function(e,t){return nn(this._ctx,e,t,this._ctx.table.core)},e.prototype.clone=function(e){var t=Object.create(this.constructor.prototype),n=Object.create(this._ctx);return e&&s(n,e),t._ctx=n,t},e.prototype.raw=function(){return this._ctx.valueMapper=null,this},e.prototype.each=function(e){var t=this._ctx;return this._read(function(n){return nn(t,e,n,t.table.core)})},e.prototype.count=function(e){var t=this;return this._read(function(e){var n=t._ctx,r=n.table.core;if(Xt(n,!0))return r.count({trans:e,query:{index:en(n,r.schema),range:n.range}}).then(function(e){return Math.min(e,n.limit)});var i=0;return nn(n,function(){return++i,!1},e,r).then(function(){return i})}).then(e)},e.prototype.sortBy=function(e,t){var n=e.split(`.`).reverse(),r=n[0],i=n.length-1;function a(e,t){return t?a(e[n[t]],t-1):e[r]}var o=this._ctx.dir===`next`?1:-1;function s(e,t){var n=a(e,i),r=a(t,i);return K(n,r)*o}return this.toArray(function(e){return e.sort(s)}).then(t)},e.prototype.toArray=function(e){var t=this;return this._read(function(e){var n=t._ctx;if(n.dir===`next`&&Xt(n,!0)&&n.limit>0){var r=n.valueMapper,i=en(n,n.table.core.schema);return n.table.core.query({trans:e,limit:n.limit,values:!0,query:{index:i,range:n.range}}).then(function(e){var t=e.result;return r?t.map(r):t})}else{var a=[];return nn(n,function(e){return a.push(e)},e,n.table.core).then(function(){return a})}},e)},e.prototype.offset=function(e){var t=this._ctx;return e<=0?this:(t.offset+=e,Xt(t)?Qt(t,function(){var t=e;return function(e,n){return t===0?!0:t===1?(--t,!1):(n(function(){e.advance(t),t=0}),!1)}}):Qt(t,function(){var t=e;return function(){return--t<0}}),this)},e.prototype.limit=function(e){return this._ctx.limit=Math.min(this._ctx.limit,e),Qt(this._ctx,function(){var t=e;return function(e,n,r){return--t<=0&&n(r),t>=0}},!0),this},e.prototype.until=function(e,t){return Zt(this._ctx,function(n,r,i){return e(n.value)?(r(i),t):!0}),this},e.prototype.first=function(e){return this.limit(1).toArray(function(e){return e[0]}).then(e)},e.prototype.last=function(e){return this.reverse().first(e)},e.prototype.filter=function(e){return Zt(this._ctx,function(t){return e(t.value)}),$t(this._ctx,e),this},e.prototype.and=function(e){return this.filter(e)},e.prototype.or=function(e){return new this.db.WhereClause(this._ctx.table,e,this)},e.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir===`prev`?`next`:`prev`,this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},e.prototype.desc=function(){return this.reverse()},e.prototype.eachKey=function(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each(function(t,n){e(n.key,n)})},e.prototype.eachUniqueKey=function(e){return this._ctx.unique=`unique`,this.eachKey(e)},e.prototype.eachPrimaryKey=function(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each(function(t,n){e(n.primaryKey,n)})},e.prototype.keys=function(e){var t=this._ctx;t.keysOnly=!t.isMatch;var n=[];return this.each(function(e,t){n.push(t.key)}).then(function(){return n}).then(e)},e.prototype.primaryKeys=function(e){var t=this._ctx;if(t.dir===`next`&&Xt(t,!0)&&t.limit>0)return this._read(function(e){var n=en(t,t.table.core.schema);return t.table.core.query({trans:e,values:!1,limit:t.limit,query:{index:n,range:t.range}})}).then(function(e){return e.result}).then(e);t.keysOnly=!t.isMatch;var n=[];return this.each(function(e,t){n.push(t.primaryKey)}).then(function(){return n}).then(e)},e.prototype.uniqueKeys=function(e){return this._ctx.unique=`unique`,this.keys(e)},e.prototype.firstKey=function(e){return this.limit(1).keys(function(e){return e[0]}).then(e)},e.prototype.lastKey=function(e){return this.reverse().firstKey(e)},e.prototype.distinct=function(){var e=this._ctx,t=e.index&&e.table.schema.idxByName[e.index];if(!t||!t.multi)return this;var n={};return Zt(this._ctx,function(e){var t=e.primaryKey.toString(),r=u(n,t);return n[t]=!0,!r}),this},e.prototype.modify=function(e){var t=this,n=this._ctx;return this._write(function(r){var i=typeof e==`function`?e:function(t){return Gt(t,e)},o=n.table.core,s=o.schema.primaryKey,c=s.outbound,l=s.extractKey,u=200,d=t.db._options.modifyChunkSize;d&&(u=typeof d==`object`?d[o.name]||d[`*`]||200:d);var f=[],p=0,m=[],h=function(e,t){var n=t.failures,r=t.numFailures;p+=e-r;for(var i=0,o=a(n);i<o.length;i++){var s=o[i];f.push(n[s])}},g=e===on;return t.clone().primaryKeys().then(function(t){var a=Xt(n)&&n.limit===1/0&&(typeof e!=`function`||g)&&{index:n.index,range:n.range},s=function(d){var f=Math.min(u,t.length-d),p=t.slice(d,d+f);return(g?Promise.resolve([]):o.getMany({trans:r,keys:p,cache:`immutable`})).then(function(m){var _=[],v=[],y=c?[]:null,b=g?p:[];if(!g)for(var x=0;x<f;++x){var S=m[x],C={value:T(S),primKey:t[d+x]};i.call(C,C.value,C)!==!1&&(C.value==null?b.push(t[d+x]):!c&&K(l(S),l(C.value))!==0?(b.push(t[d+x]),_.push(C.value)):(v.push(C.value),c&&y.push(t[d+x])))}return Promise.resolve(_.length>0&&o.mutate({trans:r,type:`add`,values:_}).then(function(e){for(var t in e.failures)b.splice(parseInt(t),1);h(_.length,e)})).then(function(){return(v.length>0||a&&typeof e==`object`)&&o.mutate({trans:r,type:`put`,keys:y,values:v,criteria:a,changeSpec:typeof e!=`function`&&e,isAdditionalChunk:d>0}).then(function(e){return h(v.length,e)})}).then(function(){return(b.length>0||a&&g)&&o.mutate({trans:r,type:`delete`,keys:b,criteria:a,isAdditionalChunk:d>0}).then(function(e){return Ut(n.table,b,e)}).then(function(e){return h(b.length,e)})}).then(function(){return t.length>d+f&&s(d+u)})})};return s(0).then(function(){if(f.length>0)throw new Ce(`Error modifying one or more objects`,f,p,m);return t.length})})})},e.prototype.delete=function(){var e=this._ctx,t=e.range;return Xt(e)&&!e.table.schema.yProps&&(e.isPrimKey||t.type===3)?this._write(function(n){var r=e.table.core.schema.primaryKey,i=t;return e.table.core.count({trans:n,query:{index:r,range:i}}).then(function(t){return e.table.core.mutate({trans:n,type:`deleteRange`,range:i}).then(function(e){var n=e.failures,r=e.numFailures;if(r)throw new Ce(`Could not delete some values`,Object.keys(n).map(function(e){return n[e]}),t-r);return t-r})})}):this.modify(on)},e}(),on=function(e,t){return t.value=null};function sn(e){return Jt(an.prototype,function(t,n){this.db=e;var r=It,i=null;if(n)try{r=n()}catch(e){i=e}var a=t._ctx,o=a.table,s=o.hook.reading.fire;this._ctx={table:o,index:a.index,isPrimKey:!a.index||o.schema.primKey.keyPath&&a.index===o.schema.primKey.name,range:r,keysOnly:!1,dir:`next`,unique:``,algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:i,or:a.or,valueMapper:s===Ae?null:s}})}function cn(e,t){return e<t?-1:e===t?0:1}function ln(e,t){return e>t?-1:e===t?0:1}function q(e,t,n){var r=e instanceof gn?new e.Collection(e):e;return r._ctx.error=n?new n(t):TypeError(t),r}function un(e){return new e.Collection(e,function(){return hn(``)}).limit(0)}function dn(e){return e===`next`?function(e){return e.toUpperCase()}:function(e){return e.toLowerCase()}}function fn(e){return e===`next`?function(e){return e.toLowerCase()}:function(e){return e.toUpperCase()}}function pn(e,t,n,r,i,a){for(var o=Math.min(e.length,r.length),s=-1,c=0;c<o;++c){var l=t[c];if(l!==r[c])return i(e[c],n[c])<0?e.substr(0,c)+n[c]+n.substr(c+1):i(e[c],r[c])<0?e.substr(0,c)+r[c]+n.substr(c+1):s>=0?e.substr(0,s)+t[s]+n.substr(s+1):null;i(e[c],l)<0&&(s=c)}return o<r.length&&a===`next`?e+n.substr(e.length):o<e.length&&a===`prev`?e.substr(0,n.length):s<0?null:e.substr(0,s)+r[s]+n.substr(s+1)}function mn(e,t,n,r){var i,a,o,s,c,l,u,d=n.length;if(!n.every(function(e){return typeof e==`string`}))return q(e,jt);function f(e){i=dn(e),a=fn(e),o=e===`next`?cn:ln;var t=n.map(function(e){return{lower:a(e),upper:i(e)}}).sort(function(e,t){return o(e.lower,t.lower)});s=t.map(function(e){return e.upper}),c=t.map(function(e){return e.lower}),l=e,u=e===`next`?``:r}f(`next`);var p=new e.Collection(e,function(){return J(s[0],c[d-1]+r)});p._ondirectionchange=function(e){f(e)};var m=0;return p._addAlgorithm(function(e,n,r){var i=e.key;if(typeof i!=`string`)return!1;var f=a(i);if(t(f,c,m))return!0;for(var p=null,h=m;h<d;++h){var g=pn(i,f,s[h],c[h],o,l);g===null&&p===null?m=h+1:(p===null||o(p,g)>0)&&(p=g)}return n(p===null?r:function(){e.continue(p+u)}),!1}),p}function J(e,t,n,r){return{type:2,lower:e,upper:t,lowerOpen:n,upperOpen:r}}function hn(e){return{type:1,lower:e,upper:e}}var gn=function(){function e(){}return Object.defineProperty(e.prototype,`Collection`,{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),e.prototype.between=function(e,t,n,r){n=n!==!1,r=r===!0;try{return this._cmp(e,t)>0||this._cmp(e,t)===0&&(n||r)&&!(n&&r)?un(this):new this.Collection(this,function(){return J(e,t,!n,!r)})}catch{return q(this,W)}},e.prototype.equals=function(e){return e==null?q(this,W):new this.Collection(this,function(){return hn(e)})},e.prototype.above=function(e){return e==null?q(this,W):new this.Collection(this,function(){return J(e,void 0,!0)})},e.prototype.aboveOrEqual=function(e){return e==null?q(this,W):new this.Collection(this,function(){return J(e,void 0,!1)})},e.prototype.below=function(e){return e==null?q(this,W):new this.Collection(this,function(){return J(void 0,e,!1,!0)})},e.prototype.belowOrEqual=function(e){return e==null?q(this,W):new this.Collection(this,function(){return J(void 0,e)})},e.prototype.startsWith=function(e){return typeof e==`string`?this.between(e,e+U,!0,!0):q(this,jt)},e.prototype.startsWithIgnoreCase=function(e){return e===``?this.startsWith(e):mn(this,function(e,t){return e.indexOf(t[0])===0},[e],U)},e.prototype.equalsIgnoreCase=function(e){return mn(this,function(e,t){return e===t[0]},[e],``)},e.prototype.anyOfIgnoreCase=function(){var e=E.apply(he,arguments);return e.length===0?un(this):mn(this,function(e,t){return t.indexOf(e)!==-1},e,``)},e.prototype.startsWithAnyOfIgnoreCase=function(){var e=E.apply(he,arguments);return e.length===0?un(this):mn(this,function(e,t){return t.some(function(t){return e.indexOf(t)===0})},e,U)},e.prototype.anyOf=function(){var e=this,t=E.apply(he,arguments),n=this._cmp;try{t.sort(n)}catch{return q(this,W)}if(t.length===0)return un(this);var r=new this.Collection(this,function(){return J(t[0],t[t.length-1])});r._ondirectionchange=function(r){n=r===`next`?e._ascending:e._descending,t.sort(n)};var i=0;return r._addAlgorithm(function(e,r,a){for(var o=e.key;n(o,t[i])>0;)if(++i,i===t.length)return r(a),!1;return n(o,t[i])===0?!0:(r(function(){e.continue(t[i])}),!1)}),r},e.prototype.notEqual=function(e){return this.inAnyRange([[At,e],[e,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},e.prototype.noneOf=function(){var e=E.apply(he,arguments);if(e.length===0)return new this.Collection(this);try{e.sort(this._ascending)}catch{return q(this,W)}var t=e.reduce(function(e,t){return e?e.concat([[e[e.length-1][1],t]]):[[At,t]]},null);return t.push([e[e.length-1],this.db._maxKey]),this.inAnyRange(t,{includeLowers:!1,includeUppers:!1})},e.prototype.inAnyRange=function(e,t){var n=this,r=this._cmp,i=this._ascending,a=this._descending,o=this._min,s=this._max;if(e.length===0)return un(this);if(!e.every(function(e){return e[0]!==void 0&&e[1]!==void 0&&i(e[0],e[1])<=0}))return q(this,`First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower`,D.InvalidArgument);var c=!t||t.includeLowers!==!1,l=t&&t.includeUppers===!0;function u(e,t){for(var n=0,i=e.length;n<i;++n){var a=e[n];if(r(t[0],a[1])<0&&r(t[1],a[0])>0){a[0]=o(a[0],t[0]),a[1]=s(a[1],t[1]);break}}return n===i&&e.push(t),e}var d=i;function f(e,t){return d(e[0],t[0])}var p;try{p=e.reduce(u,[]),p.sort(f)}catch{return q(this,W)}var m=0,h=l?function(e){return i(e,p[m][1])>0}:function(e){return i(e,p[m][1])>=0},g=c?function(e){return a(e,p[m][0])>0}:function(e){return a(e,p[m][0])>=0};function _(e){return!h(e)&&!g(e)}var v=h,y=new this.Collection(this,function(){return J(p[0][0],p[p.length-1][1],!c,!l)});return y._ondirectionchange=function(e){e===`next`?(v=h,d=i):(v=g,d=a),p.sort(f)},y._addAlgorithm(function(e,t,r){for(var a=e.key;v(a);)if(++m,m===p.length)return t(r),!1;return _(a)?!0:(n._cmp(a,p[m][1])===0||n._cmp(a,p[m][0])===0||t(function(){d===i?e.continue(p[m][0]):e.continue(p[m][1])}),!1)}),y},e.prototype.startsWithAnyOf=function(){var e=E.apply(he,arguments);return e.every(function(e){return typeof e==`string`})?e.length===0?un(this):this.inAnyRange(e.map(function(e){return[e,e+U]})):q(this,`startsWithAnyOf() only works with strings`)},e}();function _n(e){return Jt(gn.prototype,function(t,n,r){if(this.db=e,this._ctx={table:t,index:n===`:id`?null:n,or:r},this._cmp=this._ascending=K,this._descending=function(e,t){return K(t,e)},this._max=function(e,t){return K(e,t)>0?e:t},this._min=function(e,t){return K(e,t)<0?e:t},this._IDBKeyRange=e._deps.IDBKeyRange,!this._IDBKeyRange)throw new D.MissingAPI})}function Y(e){return I(function(t){return vn(t),e(t.target.error),!1})}function vn(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault()}var yn=`storagemutated`,bn=`x-storagemutated-1`,X=qt(null,yn),xn=function(){function e(){}return e.prototype._lock=function(){return b(!N.global),++this._reculock,this._reculock===1&&!N.global&&(N.lockOwnerFor=this),this},e.prototype._unlock=function(){if(b(!N.global),--this._reculock===0)for(N.global||(N.lockOwnerFor=null);this._blockedFuncs.length>0&&!this._locked();){var e=this._blockedFuncs.shift();try{V(e[1],e[0])}catch{}}return this},e.prototype._locked=function(){return this._reculock&&N.lockOwnerFor!==this},e.prototype.create=function(e){var t=this;if(!this.mode)return this;var n=this.db.idbdb,r=this.db._state.dbOpenError;if(b(!this.idbtrans),!e&&!n)switch(r&&r.name){case`DatabaseClosedError`:throw new D.DatabaseClosed(r);case`MissingAPIError`:throw new D.MissingAPI(r.message,r);default:throw new D.OpenFailed(r)}if(!this.active)throw new D.TransactionInactive;return b(this._completion._state===null),e=this.idbtrans=e||(this.db.core?this.db.core.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}):n.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})),e.onerror=I(function(n){vn(n),t._reject(e.error)}),e.onabort=I(function(n){vn(n),t.active&&t._reject(new D.Abort(e.error)),t.active=!1,t.on(`abort`).fire(n)}),e.oncomplete=I(function(){t.active=!1,t._resolve(),`mutatedParts`in e&&X.storagemutated.fire(e.mutatedParts)}),this},e.prototype._promise=function(e,t,n){var r=this;if(e===`readwrite`&&this.mode!==`readwrite`)return H(new D.ReadOnly(`Transaction is readonly`));if(!this.active)return H(new D.TransactionInactive);if(this._locked())return new F(function(i,a){r._blockedFuncs.push([function(){r._promise(e,t,n).then(i,a)},N])});if(n)return R(function(){var e=new F(function(e,n){r._lock();var i=t(e,n,r);i&&i.then&&i.then(e,n)});return e.finally(function(){return r._unlock()}),e._lib=!0,e});var i=new F(function(e,n){var i=t(e,n,r);i&&i.then&&i.then(e,n)});return i._lib=!0,i},e.prototype._root=function(){return this.parent?this.parent._root():this},e.prototype.waitFor=function(e){var t=this._root(),n=F.resolve(e);if(t._waitingFor)t._waitingFor=t._waitingFor.then(function(){return n});else{t._waitingFor=n,t._waitingQueue=[];var r=t.idbtrans.objectStore(t.storeNames[0]);(function e(){for(++t._spinCount;t._waitingQueue.length;)t._waitingQueue.shift()();t._waitingFor&&(r.get(-1/0).onsuccess=e)})()}var i=t._waitingFor;return new F(function(e,r){n.then(function(n){return t._waitingQueue.push(I(e.bind(null,n)))},function(e){return t._waitingQueue.push(I(r.bind(null,e)))}).finally(function(){t._waitingFor===i&&(t._waitingFor=null)})})},e.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new D.Abort))},e.prototype.table=function(e){var t=this._memoizedTables||={};if(u(t,e))return t[e];var n=this.schema[e];if(!n)throw new D.NotFound(`Table `+e+` not part of transaction`);var r=new this.db.Table(e,n,this);return r.core=this.db.core.table(e),t[e]=r,r},e}();function Sn(e){return Jt(xn.prototype,function(t,n,r,i,a){var o=this;t!==`readonly`&&n.forEach(function(e){var t=r[e]?.yProps;t&&(n=n.concat(t.map(function(e){return e.updatesTable})))}),this.db=e,this.mode=t,this.storeNames=n,this.schema=r,this.chromeTransactionDurability=i,this.idbtrans=null,this.on=qt(this,`complete`,`error`,`abort`),this.parent=a||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new F(function(e,t){o._resolve=e,o._reject=t}),this._completion.then(function(){o.active=!1,o.on.complete.fire()},function(e){var t=o.active;return o.active=!1,o.on.error.fire(e),o.parent?o.parent._reject(e):t&&o.idbtrans&&o.idbtrans.abort(),H(e)})})}function Cn(e,t,n,r,i,a,o,s){return{name:e,keyPath:t,unique:n,multi:r,auto:i,compound:a,src:(n&&!o?`&`:``)+(r?`*`:``)+(i?`++`:``)+wn(t),type:s}}function wn(e){return typeof e==`string`?e:e?`[`+[].join.call(e,`+`)+`]`:``}function Tn(e,t,n){return{name:e,primKey:t,indexes:n,mappedClass:null,idxByName:S(n,function(e){return[e.name,e]})}}function En(e){return e.length===1?e[0]:e}var Dn=function(e){try{return e.only([[]]),Dn=function(){return[[]]},[[]]}catch{return Dn=function(){return U},U}};function On(e){return e==null?function(){}:typeof e==`string`?kn(e):function(t){return C(t,e)}}function kn(e){return e.split(`.`).length===1?function(t){return t[e]}:function(t){return C(t,e)}}function An(e){return[].slice.call(e)}var jn=0;function Mn(e){return e==null?`:id`:typeof e==`string`?e:`[${e.join(`+`)}]`}function Nn(e,t,n){function r(e,t){var n=An(e.objectStoreNames);return{schema:{name:e.name,tables:n.map(function(e){return t.objectStore(e)}).map(function(e){var t=e.keyPath,n=e.autoIncrement,r=o(t),i=t==null,a={},s={name:e.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:i,compound:r,keyPath:t,autoIncrement:n,unique:!0,extractKey:On(t)},indexes:An(e.indexNames).map(function(t){return e.index(t)}).map(function(e){var t=e.name,n=e.unique,r=e.multiEntry,i=e.keyPath,s=o(i),c={name:t,compound:s,keyPath:i,unique:n,multiEntry:r,extractKey:On(i)};return a[Mn(i)]=c,c}),getIndexByKeyPath:function(e){return a[Mn(e)]}};return a[`:id`]=s.primaryKey,t!=null&&(a[Mn(t)]=s.primaryKey),s})},hasGetAll:n.length>0&&`getAll`in t.objectStore(n[0])&&!(typeof navigator<`u`&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}}function i(e){if(e.type===3)return null;if(e.type===4)throw Error(`Cannot convert never type to IDBKeyRange`);var n=e.lower,r=e.upper,i=e.lowerOpen,a=e.upperOpen;return n===void 0?r===void 0?null:t.upperBound(r,!!a):r===void 0?t.lowerBound(n,!!i):t.bound(n,r,!!i,!!a)}function a(e){var t=e.name;function n(e){var n=e.trans,r=e.type,a=e.keys,o=e.values,s=e.range;return new Promise(function(e,c){e=I(e);var l=n.objectStore(t),u=l.keyPath==null,d=r===`put`||r===`add`;if(!d&&r!==`delete`&&r!==`deleteRange`)throw Error(`Invalid operation type: `+r);var f=(a||o||{length:1}).length;if(a&&o&&a.length!==o.length)throw Error(`Given keys array must have same length as given values array.`);if(f===0)return e({numFailures:0,failures:{},results:[],lastResult:void 0});var p,m=[],h=[],g=0,_=function(e){++g,vn(e)};if(r===`deleteRange`){if(s.type===4)return e({numFailures:g,failures:h,results:[],lastResult:void 0});s.type===3?m.push(p=l.clear()):m.push(p=l.delete(i(s)))}else{var v=d?u?[o,a]:[o,null]:[a,null],y=v[0],b=v[1];if(d)for(var x=0;x<f;++x)m.push(p=b&&b[x]!==void 0?l[r](y[x],b[x]):l[r](y[x])),p.onerror=_;else for(var x=0;x<f;++x)m.push(p=l[r](y[x])),p.onerror=_}var S=function(t){var n=t.target.result;m.forEach(function(e,t){return e.error!=null&&(h[t]=e.error)}),e({numFailures:g,failures:h,results:r===`delete`?a:m.map(function(e){return e.result}),lastResult:n})};p.onerror=function(e){_(e),S(e)},p.onsuccess=S})}function r(e){var n=e.trans,r=e.values,a=e.query,o=e.reverse,s=e.unique;return new Promise(function(e,c){e=I(e);var l=a.index,u=a.range,d=n.objectStore(t),f=l.isPrimaryKey?d:d.index(l.name),p=o?s?`prevunique`:`prev`:s?`nextunique`:`next`,m=r||!(`openKeyCursor`in f)?f.openCursor(i(u),p):f.openKeyCursor(i(u),p);m.onerror=Y(c),m.onsuccess=I(function(t){var r=m.result;if(!r){e(null);return}r.___id=++jn,r.done=!1;var i=r.continue.bind(r),a=r.continuePrimaryKey;a&&=a.bind(r);var o=r.advance.bind(r),s=function(){throw Error(`Cursor not started`)},l=function(){throw Error(`Cursor not stopped`)};r.trans=n,r.stop=r.continue=r.continuePrimaryKey=r.advance=s,r.fail=I(c),r.next=function(){var e=this,t=1;return this.start(function(){return t--?e.continue():e.stop()}).then(function(){return e})},r.start=function(e){var t=new Promise(function(e,t){e=I(e),m.onerror=Y(t),r.fail=t,r.stop=function(t){r.stop=r.continue=r.continuePrimaryKey=r.advance=l,e(t)}}),n=function(){if(m.result)try{e()}catch(e){r.fail(e)}else r.done=!0,r.start=function(){throw Error(`Cursor behind last entry`)},r.stop()};return m.onsuccess=I(function(e){m.onsuccess=n,n()}),r.continue=i,r.continuePrimaryKey=a,r.advance=o,n(),t},e(r)},c)})}function a(e){return function(n){return new Promise(function(r,a){r=I(r);var o=n.trans,s=n.values,c=n.limit,l=n.query,u=c===1/0?void 0:c,d=l.index,f=l.range,p=o.objectStore(t),m=d.isPrimaryKey?p:p.index(d.name),h=i(f);if(c===0)return r({result:[]});if(e){var g=s?m.getAll(h,u):m.getAllKeys(h,u);g.onsuccess=function(e){return r({result:e.target.result})},g.onerror=Y(a)}else{var _=0,v=s||!(`openKeyCursor`in m)?m.openCursor(h):m.openKeyCursor(h),y=[];v.onsuccess=function(e){var t=v.result;if(!t||(y.push(s?t.value:t.primaryKey),++_===c))return r({result:y});t.continue()},v.onerror=Y(a)}})}}return{name:t,schema:e,mutate:n,getMany:function(e){var n=e.trans,r=e.keys;return new Promise(function(e,i){e=I(e);for(var a=n.objectStore(t),o=r.length,s=Array(o),c=0,l=0,u,d=function(t){var n=t.target;s[n._pos]=n.result,++l===c&&e(s)},f=Y(i),p=0;p<o;++p)r[p]!=null&&(u=a.get(r[p]),u._pos=p,u.onsuccess=d,u.onerror=f,++c);c===0&&e(s)})},get:function(e){var n=e.trans,r=e.key;return new Promise(function(e,i){e=I(e);var a=n.objectStore(t).get(r);a.onsuccess=function(t){return e(t.target.result)},a.onerror=Y(i)})},query:a(l),openCursor:r,count:function(e){var n=e.query,r=e.trans,a=n.index,o=n.range;return new Promise(function(e,n){var s=r.objectStore(t),c=a.isPrimaryKey?s:s.index(a.name),l=i(o),u=l?c.count(l):c.count();u.onsuccess=I(function(t){return e(t.target.result)}),u.onerror=Y(n)})}}}var s=r(e,n),c=s.schema,l=s.hasGetAll,u=c.tables.map(function(e){return a(e)}),d={};return u.forEach(function(e){return d[e.name]=e}),{stack:`dbcore`,transaction:e.transaction.bind(e),table:function(e){if(!d[e])throw Error(`Table '${e}' not found`);return d[e]},MIN_KEY:-1/0,MAX_KEY:Dn(t),schema:c}}function Pn(e,t){return t.reduce(function(e,t){var r=t.create;return n(n({},e),r(e))},e)}function Fn(e,t,n,r){var i=n.IDBKeyRange;return n.indexedDB,{dbcore:Pn(Nn(t,i,r),e.dbcore)}}function In(e,t){var n=t.db;e.core=Fn(e._middlewares,n,e._deps,t).dbcore,e.tables.forEach(function(t){var n=t.name;e.core.schema.tables.some(function(e){return e.name===n})&&(t.core=e.core.table(n),e[n]instanceof e.Table&&(e[n].core=t.core))})}function Ln(e,t,n,r){n.forEach(function(n){var i=r[n];t.forEach(function(t){var r=g(t,n);(!r||`value`in r&&r.value===void 0)&&(t===e.Transaction.prototype||t instanceof e.Transaction?p(t,n,{get:function(){return this.table(n)},set:function(e){f(this,n,{value:e,writable:!0,configurable:!0,enumerable:!0})}}):t[n]=new e.Table(n,i))})})}function Rn(e,t){t.forEach(function(t){for(var n in t)t[n]instanceof e.Table&&delete t[n]})}function zn(e,t){return e._cfg.version-t._cfg.version}function Bn(e,t,n,r){var i=e._dbSchema;n.objectStoreNames.contains(`$meta`)&&!i.$meta&&(i.$meta=Tn(`$meta`,$n(``)[0],[]),e._storeNames.push(`$meta`));var o=e._createTransaction(`readwrite`,e._storeNames,i);o.create(n),o._completion.catch(r);var s=o._reject.bind(o),c=N.transless||N;R(function(){if(N.trans=o,N.transless=c,t===0)a(i).forEach(function(e){Gn(n,e,i[e].primKey,i[e].indexes)}),In(e,n),F.follow(function(){return e.on.populate.fire(o)}).catch(s);else return In(e,n),Hn(e,o,t).then(function(t){return Un(e,t,o,n)}).catch(s)})}function Vn(e,t){Kn(e._dbSchema,t),t.db.version%10==0&&!t.objectStoreNames.contains(`$meta`)&&t.db.createObjectStore(`$meta`).add(Math.ceil(t.db.version/10-1),`version`);var n=Yn(e,e.idbdb,t);Qn(e,e._dbSchema,t);for(var r=Wn(n,e._dbSchema),i=function(e){if(e.change.length||e.recreate)return console.warn(`Unable to patch indexes of table ${e.name} because it has changes on the type of index or primary key.`),{value:void 0};var n=t.objectStore(e.name);e.add.forEach(function(t){A&&console.debug(`Dexie upgrade patch: Creating missing index ${e.name}.${t.src}`),Jn(n,t)})},a=0,o=r.change;a<o.length;a++){var s=o[a],c=i(s);if(typeof c==`object`)return c.value}}function Hn(e,t,n){return t.storeNames.includes(`$meta`)?t.table(`$meta`).get(`version`).then(function(e){return e??n}):F.resolve(n)}function Un(e,t,n,r){var i=[],o=e._versions,s=e._dbSchema=Yn(e,e.idbdb,r),c=o.filter(function(e){return e._cfg.version>=t});if(c.length===0)return F.resolve();c.forEach(function(o){i.push(function(){var i=s,c=o._cfg.dbschema;Qn(e,i,r),Qn(e,c,r),s=e._dbSchema=c;var l=Wn(i,c);l.add.forEach(function(e){Gn(r,e[0],e[1].primKey,e[1].indexes)}),l.change.forEach(function(e){if(e.recreate)throw new D.Upgrade(`Not yet support for changing primary key`);var t=r.objectStore(e.name);e.add.forEach(function(e){return Jn(t,e)}),e.change.forEach(function(e){t.deleteIndex(e.name),Jn(t,e)}),e.del.forEach(function(e){return t.deleteIndex(e)})});var u=o._cfg.contentUpgrade;if(u&&o._cfg.version>t){In(e,r),n._memoizedTables={};var d=te(c);l.del.forEach(function(e){d[e]=i[e]}),Rn(e,[e.Transaction.prototype]),Ln(e,[e.Transaction.prototype],a(d),d),n.schema=d;var f=ge(u);f&&xt();var p,m=F.follow(function(){if(p=u(n),p&&f){var e=z.bind(null,null);p.then(e,e)}});return p&&typeof p.then==`function`?F.resolve(p):m.then(function(){return p})}}),i.push(function(t){var r=o._cfg.dbschema;qn(r,t),Rn(e,[e.Transaction.prototype]),Ln(e,[e.Transaction.prototype],e._storeNames,e._dbSchema),n.schema=e._dbSchema}),i.push(function(t){e.idbdb.objectStoreNames.contains(`$meta`)&&(Math.ceil(e.idbdb.version/10)===o._cfg.version?(e.idbdb.deleteObjectStore(`$meta`),delete e._dbSchema.$meta,e._storeNames=e._storeNames.filter(function(e){return e!==`$meta`})):t.objectStore(`$meta`).put(o._cfg.version,`version`))})});function l(){return i.length?F.resolve(i.shift()(n.idbtrans)).then(l):F.resolve()}return l().then(function(){Kn(s,r)})}function Wn(e,t){var n={del:[],add:[],change:[]},r;for(r in e)t[r]||n.del.push(r);for(r in t){var i=e[r],a=t[r];if(!i)n.add.push([r,a]);else{var o={name:r,def:a,recreate:!1,del:[],add:[],change:[]};if(``+(i.primKey.keyPath||``)!=``+(a.primKey.keyPath||``)||i.primKey.auto!==a.primKey.auto)o.recreate=!0,n.change.push(o);else{var s=i.idxByName,c=a.idxByName,l=void 0;for(l in s)c[l]||o.del.push(l);for(l in c){var u=s[l],d=c[l];u?u.src!==d.src&&o.change.push(d):o.add.push(d)}(o.del.length>0||o.add.length>0||o.change.length>0)&&n.change.push(o)}}}return n}function Gn(e,t,n,r){var i=e.db.createObjectStore(t,n.keyPath?{keyPath:n.keyPath,autoIncrement:n.auto}:{autoIncrement:n.auto});return r.forEach(function(e){return Jn(i,e)}),i}function Kn(e,t){a(e).forEach(function(n){t.db.objectStoreNames.contains(n)||(A&&console.debug(`Dexie: Creating missing table`,n),Gn(t,n,e[n].primKey,e[n].indexes))})}function qn(e,t){[].slice.call(t.db.objectStoreNames).forEach(function(n){return e[n]==null&&t.db.deleteObjectStore(n)})}function Jn(e,t){e.createIndex(t.name,t.keyPath,{unique:t.unique,multiEntry:t.multi})}function Yn(e,t,n){var r={};return v(t.objectStoreNames,0).forEach(function(e){for(var t=n.objectStore(e),i=t.keyPath,a=Cn(wn(i),i||``,!0,!1,!!t.autoIncrement,i&&typeof i!=`string`,!0),o=[],s=0;s<t.indexNames.length;++s){var c=t.index(t.indexNames[s]);i=c.keyPath;var l=Cn(c.name,i,!!c.unique,!!c.multiEntry,!1,i&&typeof i!=`string`,!1);o.push(l)}r[e]=Tn(e,a,o)}),r}function Xn(e,t,n){e.verno=t.version/10;var r=e._dbSchema=Yn(e,t,n);e._storeNames=v(t.objectStoreNames,0),Ln(e,[e._allTables],a(r),r)}function Zn(e,t){var n=Yn(e,e.idbdb,t),r=Wn(n,e._dbSchema);return!(r.add.length||r.change.some(function(e){return e.add.length||e.change.length}))}function Qn(e,t,n){for(var r=n.db.objectStoreNames,a=0;a<r.length;++a){var o=r[a],s=n.objectStore(o);e._hasGetAll=`getAll`in s;for(var c=0;c<s.indexNames.length;++c){var l=s.indexNames[c],u=s.index(l).keyPath,d=typeof u==`string`?u:`[`+v(u).join(`+`)+`]`;if(t[o]){var f=t[o].idxByName[d];f&&(f.name=l,delete t[o].idxByName[d],t[o].idxByName[l]=f)}}}typeof navigator<`u`&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&i.WorkerGlobalScope&&i instanceof i.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(e._hasGetAll=!1)}function $n(e){return e.split(`,`).map(function(e,t){var n=e.split(`:`),r=n[1]?.trim();e=n[0].trim();var i=e.replace(/([&*]|\+\+)/g,``),a=/^\[/.test(i)?i.match(/^\[(.*)\]$/)[1].split(`+`):i;return Cn(i,a||null,/\&/.test(e),/\*/.test(e),/\+\+/.test(e),o(a),t===0,r)})}var er=function(){function e(){}return e.prototype._createTableSchema=function(e,t,n){return Tn(e,t,n)},e.prototype._parseIndexSyntax=function(e){return $n(e)},e.prototype._parseStoresSpec=function(e,t){var n=this;a(e).forEach(function(r){if(e[r]!==null){var i=n._parseIndexSyntax(e[r]),a=i.shift();if(!a)throw new D.Schema(`Invalid schema for table `+r+`: `+e[r]);if(a.unique=!0,a.multi)throw new D.Schema(`Primary key cannot be multiEntry*`);i.forEach(function(e){if(e.auto)throw new D.Schema(`Only primary key can be marked as autoIncrement (++)`);if(!e.keyPath)throw new D.Schema(`Index must have a name and cannot be an empty string`)}),t[r]=n._createTableSchema(r,a,i)}})},e.prototype.stores=function(e){var t=this.db;this._cfg.storesSource=this._cfg.storesSource?s(this._cfg.storesSource,e):e;var n=t._versions,r={},i={};return n.forEach(function(e){s(r,e._cfg.storesSource),i=e._cfg.dbschema={},e._parseStoresSpec(r,i)}),t._dbSchema=i,Rn(t,[t._allTables,t,t.Transaction.prototype]),Ln(t,[t._allTables,t,t.Transaction.prototype,this._cfg.tables],a(i),i),t._storeNames=a(i),this},e.prototype.upgrade=function(e){return this._cfg.contentUpgrade=Ie(this._cfg.contentUpgrade||O,e),this},e}();function tr(e){return Jt(er.prototype,function(t){this.db=e,this._cfg={version:t,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})}function nr(e,t){var n=e._dbNamesDB;return n||(n=e._dbNamesDB=new Q(Nt,{addons:[],indexedDB:e,IDBKeyRange:t}),n.version(1).stores({dbnames:`name`})),n.table(`dbnames`)}function rr(e){return e&&typeof e.databases==`function`}function ir(e){var t=e.indexedDB,n=e.IDBKeyRange;return rr(t)?Promise.resolve(t.databases()).then(function(e){return e.map(function(e){return e.name}).filter(function(e){return e!==Nt})}):nr(t,n).toCollection().primaryKeys()}function ar(e,t){var n=e.indexedDB,r=e.IDBKeyRange;!rr(n)&&t!==Nt&&nr(n,r).put({name:t}).catch(O)}function or(e,t){var n=e.indexedDB,r=e.IDBKeyRange;!rr(n)&&t!==Nt&&nr(n,r).delete(t).catch(O)}function sr(e){return R(function(){return N.letThrough=!0,e()})}function cr(){if(!(!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent))||!indexedDB.databases)return Promise.resolve();var e;return new Promise(function(t){var n=function(){return indexedDB.databases().finally(t)};e=setInterval(n,100),n()}).finally(function(){return clearInterval(e)})}var lr;function ur(e){return!(`from`in e)}var Z=function(e,t){if(this)s(this,arguments.length?{d:1,from:e,to:arguments.length>1?t:e}:{d:0});else{var n=new Z;return e&&`d`in e&&s(n,e),n}};d(Z.prototype,(lr={add:function(e){return fr(this,e),this},addKey:function(e){return dr(this,e,e),this},addKeys:function(e){var t=this;return e.forEach(function(e){return dr(t,e,e)}),this},hasKey:function(e){var t=mr(this).next(e).value;return t&&K(t.from,e)<=0&&K(t.to,e)>=0}},lr[fe]=function(){return mr(this)},lr));function dr(e,t,n){var r=K(t,n);if(!isNaN(r)){if(r>0)throw RangeError();if(ur(e))return s(e,{from:t,to:n,d:1});var i=e.l,a=e.r;if(K(n,e.from)<0)return i?dr(i,t,n):e.l={from:t,to:n,d:1,l:null,r:null},hr(e);if(K(t,e.to)>0)return a?dr(a,t,n):e.r={from:t,to:n,d:1,l:null,r:null},hr(e);K(t,e.from)<0&&(e.from=t,e.l=null,e.d=a?a.d+1:1),K(n,e.to)>0&&(e.to=n,e.r=null,e.d=e.l?e.l.d+1:1);var o=!e.r;i&&!e.l&&fr(e,i),a&&o&&fr(e,a)}}function fr(e,t){function n(e,t){var r=t.from,i=t.to,a=t.l,o=t.r;dr(e,r,i),a&&n(e,a),o&&n(e,o)}ur(t)||n(e,t)}function pr(e,t){var n=mr(t),r=n.next();if(r.done)return!1;for(var i=r.value,a=mr(e),o=a.next(i.from),s=o.value;!r.done&&!o.done;){if(K(s.from,i.to)<=0&&K(s.to,i.from)>=0)return!0;K(i.from,s.from)<0?i=(r=n.next(s.from)).value:s=(o=a.next(i.from)).value}return!1}function mr(e){var t=ur(e)?null:{s:0,n:e};return{next:function(e){for(var n=arguments.length>0;t;)switch(t.s){case 0:if(t.s=1,n)for(;t.n.l&&K(e,t.n.from)<0;)t={up:t,n:t.n.l,s:1};else for(;t.n.l;)t={up:t,n:t.n.l,s:1};case 1:if(t.s=2,!n||K(e,t.n.to)<=0)return{value:t.n,done:!1};case 2:if(t.n.r){t.s=3,t={up:t,n:t.n.r,s:0};continue}case 3:t=t.up}return{done:!0}}}}function hr(e){var t=(e.r?.d||0)-(e.l?.d||0),r=t>1?`r`:t<-1?`l`:``;if(r){var i=r===`r`?`l`:`r`,a=n({},e),o=e[r];e.from=o.from,e.to=o.to,e[r]=o[r],a[r]=o[i],e[i]=a,a.d=gr(a)}e.d=gr(e)}function gr(e){var t=e.r,n=e.l;return(t?n?Math.max(t.d,n.d):t.d:n?n.d:0)+1}function _r(e,t){return a(t).forEach(function(n){e[n]?fr(e[n],t[n]):e[n]=oe(t[n])}),e}function vr(e,t){return e.all||t.all||Object.keys(e).some(function(n){return t[n]&&pr(t[n],e[n])})}var yr={},br={},xr=!1;function Sr(e,t){_r(br,e),xr||(xr=!0,setTimeout(function(){xr=!1;var e=br;br={},Cr(e,!1)},0))}function Cr(e,t){t===void 0&&(t=!1);var n=new Set;if(e.all)for(var r=0,i=Object.values(yr);r<i.length;r++){var a=i[r];wr(a,e,n,t)}else for(var o in e){var s=/^idb\:\/\/(.*)\/(.*)\//.exec(o);if(s){var c=s[1],l=s[2],a=yr[`idb://${c}/${l}`];a&&wr(a,e,n,t)}}n.forEach(function(e){return e()})}function wr(e,t,n,r){for(var i=[],a=0,o=Object.entries(e.queries.query);a<o.length;a++){for(var s=o[a],c=s[0],l=s[1],u=[],d=0,f=l;d<f.length;d++){var p=f[d];vr(t,p.obsSet)?p.subscribers.forEach(function(e){return n.add(e)}):r&&u.push(p)}r&&i.push([c,u])}if(r)for(var m=0,h=i;m<h.length;m++){var g=h[m],c=g[0],u=g[1];e.queries.query[c]=u}}function Tr(e){var t=e._state,n=e._deps.indexedDB;if(t.isBeingOpened||e.idbdb)return t.dbReadyPromise.then(function(){return t.dbOpenError?H(t.dbOpenError):e});t.isBeingOpened=!0,t.dbOpenError=null,t.openComplete=!1;var r=t.openCanceller,i=Math.round(e.verno*10),a=!1;function o(){if(t.openCanceller!==r)throw new D.DatabaseClosed(`db.open() was cancelled`)}var s=t.dbReadyResolve,c=null,l=!1,u=function(){return new F(function(r,s){if(o(),!n)throw new D.MissingAPI;var d=e.name,f=t.autoSchema||!i?n.open(d):n.open(d,i);if(!f)throw new D.MissingAPI;f.onerror=Y(s),f.onblocked=I(e._fireOnBlocked),f.onupgradeneeded=I(function(r){if(c=f.transaction,t.autoSchema&&!e._options.allowEmptyDB){f.onerror=vn,c.abort(),f.result.close();var i=n.deleteDatabase(d);i.onsuccess=i.onerror=I(function(){s(new D.NoSuchDatabase(`Database ${d} doesnt exist`))})}else{c.onerror=Y(s);var o=r.oldVersion>2**62?0:r.oldVersion;l=o<1,e.idbdb=f.result,a&&Vn(e,c),Bn(e,o/10,c,s)}},s),f.onsuccess=I(function(){c=null;var n=e.idbdb=f.result,o=v(n.objectStoreNames);if(o.length>0)try{var s=n.transaction(En(o),`readonly`);if(t.autoSchema)Xn(e,n,s);else if(Qn(e,e._dbSchema,s),!Zn(e,s)&&!a)return console.warn(`Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this.`),n.close(),i=n.version+1,a=!0,r(u());In(e,s)}catch{}Mt.push(e),n.onversionchange=I(function(n){t.vcFired=!0,e.on(`versionchange`).fire(n)}),n.onclose=I(function(){e.close({disableAutoOpen:!1})}),l&&ar(e._deps,d),r()},s)}).catch(function(e){switch(e?.name){case`UnknownError`:if(t.PR1398_maxLoop>0)return t.PR1398_maxLoop--,console.warn(`Dexie: Workaround for Chrome UnknownError on open()`),u();break;case`VersionError`:if(i>0)return i=0,u();break}return F.reject(e)})};return F.race([r,(typeof navigator>`u`?F.resolve():cr()).then(u)]).then(function(){return o(),t.onReadyBeingFired=[],F.resolve(sr(function(){return e.on.ready.fire(e.vip)})).then(function n(){if(t.onReadyBeingFired.length>0){var r=t.onReadyBeingFired.reduce(Ie,O);return t.onReadyBeingFired=[],F.resolve(sr(function(){return r(e.vip)})).then(n)}})}).finally(function(){t.openCanceller===r&&(t.onReadyBeingFired=null,t.isBeingOpened=!1)}).catch(function(n){t.dbOpenError=n;try{c&&c.abort()}catch{}return r===t.openCanceller&&e._close(),H(n)}).finally(function(){t.openComplete=!0,s()}).then(function(){if(l){var t={};e.tables.forEach(function(n){n.schema.indexes.forEach(function(r){r.name&&(t[`idb://${e.name}/${n.name}/${r.name}`]=new Z(-1/0,[[[]]]))}),t[`idb://${e.name}/${n.name}/`]=t[`idb://${e.name}/${n.name}/:dels`]=new Z(-1/0,[[[]]])}),X(yn).fire(t),Cr(t,!0)}return e})}function Er(e){var t=function(t){return e.next(t)},n=function(t){return e.throw(t)},r=a(t),i=a(n);function a(e){return function(t){var n=e(t),a=n.value;return n.done?a:!a||typeof a.then!=`function`?o(a)?Promise.all(a).then(r,i):r(a):a.then(r,i)}}return a(t)()}function Dr(e,t,n){var r=arguments.length;if(r<2)throw new D.InvalidArgument(`Too few arguments`);for(var i=Array(r-1);--r;)i[r-1]=arguments[r];n=i.pop();var a=re(i);return[e,a,n]}function Or(e,t,n,r,i){return F.resolve().then(function(){var a=N.transless||N,o=e._createTransaction(t,n,e._dbSchema,r);o.explicit=!0;var s={trans:o,transless:a};if(r)o.idbtrans=r.idbtrans;else try{o.create(),o.idbtrans._explicit=!0,e._state.PR1398_maxLoop=3}catch(r){return r.name===Te.InvalidState&&e.isOpen()&&--e._state.PR1398_maxLoop>0?(console.warn(`Dexie: Need to reopen db`),e.close({disableAutoOpen:!1}),e.open().then(function(){return Or(e,t,n,null,i)})):H(r)}var c=ge(i);c&&xt();var l,u=F.follow(function(){if(l=i.call(o,o),l)if(c){var e=z.bind(null,null);l.then(e,e)}else typeof l.next==`function`&&typeof l.throw==`function`&&(l=Er(l))},s);return(l&&typeof l.then==`function`?F.resolve(l).then(function(e){return o.active?e:H(new D.PrematureCommit(`Transaction committed too early. See http://bit.ly/2kdckMn`))}):u.then(function(){return l})).then(function(e){return r&&o._resolve(),o._completion.then(function(){return e})}).catch(function(e){return o._reject(e),H(e)})})}function kr(e,t,n){for(var r=o(e)?e.slice():[e],i=0;i<n;++i)r.push(t);return r}function Ar(e){return n(n({},e),{table:function(t){var r=e.table(t),i=r.schema,a={},o=[];function s(e,t,r){var i=Mn(e),c=a[i]=a[i]||[],l=e==null?0:typeof e==`string`?1:e.length,u=t>0,d=n(n({},r),{name:u?`${i}(virtual-from:${r.name})`:r.name,lowLevelIndex:r,isVirtual:u,keyTail:t,keyLength:l,extractKey:On(e),unique:!u&&r.unique});if(c.push(d),d.isPrimaryKey||o.push(d),l>1){var f=l===2?e[0]:e.slice(0,l-1);s(f,t+1,r)}return c.sort(function(e,t){return e.keyTail-t.keyTail}),d}var c=s(i.primaryKey.keyPath,0,i.primaryKey);a[`:id`]=[c];for(var l=0,u=i.indexes;l<u.length;l++){var d=u[l];s(d.keyPath,0,d)}function f(e){var t=a[Mn(e)];return t&&t[0]}function p(t,n){return{type:t.type===1?2:t.type,lower:kr(t.lower,t.lowerOpen?e.MAX_KEY:e.MIN_KEY,n),lowerOpen:!0,upper:kr(t.upper,t.upperOpen?e.MIN_KEY:e.MAX_KEY,n),upperOpen:!0}}function m(e){var t=e.query.index;return t.isVirtual?n(n({},e),{query:{index:t.lowLevelIndex,range:p(e.query.range,t.keyTail)}}):e}return n(n({},r),{schema:n(n({},i),{primaryKey:c,indexes:o,getIndexByKeyPath:f}),count:function(e){return r.count(m(e))},query:function(e){return r.query(m(e))},openCursor:function(t){var n=t.query.index,i=n.keyTail,a=n.isVirtual,o=n.keyLength;if(!a)return r.openCursor(t);function s(n){function r(r){r==null?t.unique?n.continue(n.key.slice(0,o).concat(t.reverse?e.MIN_KEY:e.MAX_KEY,i)):n.continue():n.continue(kr(r,t.reverse?e.MAX_KEY:e.MIN_KEY,i))}return Object.create(n,{continue:{value:r},continuePrimaryKey:{value:function(t,r){n.continuePrimaryKey(kr(t,e.MAX_KEY,i),r)}},primaryKey:{get:function(){return n.primaryKey}},key:{get:function(){var e=n.key;return o===1?e[0]:e.slice(0,o)}},value:{get:function(){return n.value}}})}return r.openCursor(m(t)).then(function(e){return e&&s(e)})}})}})}var jr={stack:`dbcore`,name:`VirtualIndexMiddleware`,level:1,create:Ar};function Mr(e,t,n,r){return n||={},r||=``,a(e).forEach(function(i){if(!u(t,i))n[r+i]=void 0;else{var a=e[i],o=t[i];if(typeof a==`object`&&typeof o==`object`&&a&&o){var s=de(a),c=de(o);s===c?s===`Object`?Mr(a,o,n,r+i+`.`):a!==o&&(n[r+i]=t[i]):n[r+i]=t[i]}else a!==o&&(n[r+i]=t[i])}}),a(t).forEach(function(i){u(e,i)||(n[r+i]=t[i])}),n}function Nr(e,t){return t.type===`delete`?t.keys:t.keys||t.values.map(e.extractKey)}var Pr={stack:`dbcore`,name:`HooksMiddleware`,level:2,create:function(e){return n(n({},e),{table:function(t){var i=e.table(t),a=i.schema.primaryKey;return n(n({},i),{mutate:function(e){var o=N.trans,s=o.table(t).hook,c=s.deleting,l=s.creating,d=s.updating;switch(e.type){case`add`:if(l.fire===O)break;return o._promise(`readwrite`,function(){return f(e)},!0);case`put`:if(l.fire===O&&d.fire===O)break;return o._promise(`readwrite`,function(){return f(e)},!0);case`delete`:if(c.fire===O)break;return o._promise(`readwrite`,function(){return f(e)},!0);case`deleteRange`:if(c.fire===O)break;return o._promise(`readwrite`,function(){return p(e)},!0)}return i.mutate(e);function f(e){var t=N.trans,o=e.keys||Nr(a,e);if(!o)throw Error(`Keys missing`);return e=e.type===`add`||e.type===`put`?n(n({},e),{keys:o}):n({},e),e.type!==`delete`&&(e.values=r([],e.values,!0)),e.keys&&=r([],e.keys,!0),Fr(i,e,o).then(function(n){var r=o.map(function(r,i){var o=n[i],s={onerror:null,onsuccess:null};if(e.type===`delete`)c.fire.call(s,r,o,t);else if(e.type===`add`||o===void 0){var f=l.fire.call(s,r,e.values[i],t);r==null&&f!=null&&(r=f,e.keys[i]=r,a.outbound||w(e.values[i],a.keyPath,r))}else{var p=Mr(o,e.values[i]),m=d.fire.call(s,p,r,o,t);if(m){var h=e.values[i];Object.keys(m).forEach(function(e){u(h,e)?h[e]=m[e]:w(h,e,m[e])})}}return s});return i.mutate(e).then(function(t){for(var i=t.failures,a=t.results,s=t.numFailures,c=t.lastResult,l=0;l<o.length;++l){var u=a?a[l]:o[l],d=r[l];u==null?d.onerror&&d.onerror(i[l]):d.onsuccess&&d.onsuccess(e.type===`put`&&n[l]?e.values[l]:u)}return{failures:i,results:a,numFailures:s,lastResult:c}}).catch(function(e){return r.forEach(function(t){return t.onerror&&t.onerror(e)}),Promise.reject(e)})})}function p(e){return m(e.trans,e.range,1e4)}function m(e,t,r){return i.query({trans:e,values:!1,query:{index:a,range:t},limit:r}).then(function(i){var a=i.result;return f({type:`delete`,keys:a,trans:e}).then(function(i){return i.numFailures>0?Promise.reject(i.failures[0]):a.length<r?{failures:[],numFailures:0,lastResult:void 0}:m(e,n(n({},t),{lower:a[a.length-1],lowerOpen:!0}),r)})})}}})}})}};function Fr(e,t,n){return t.type===`add`?Promise.resolve([]):e.getMany({trans:t.trans,keys:n,cache:`immutable`})}function Ir(e,t,n){try{if(!t||t.keys.length<e.length)return null;for(var r=[],i=0,a=0;i<t.keys.length&&a<e.length;++i)K(t.keys[i],e[a])===0&&(r.push(n?T(t.values[i]):t.values[i]),++a);return r.length===e.length?r:null}catch{return null}}var Lr={stack:`dbcore`,level:-1,create:function(e){return{table:function(t){var r=e.table(t);return n(n({},r),{getMany:function(e){if(!e.cache)return r.getMany(e);var t=Ir(e.keys,e.trans._cache,e.cache===`clone`);return t?F.resolve(t):r.getMany(e).then(function(t){return e.trans._cache={keys:e.keys,values:e.cache===`clone`?T(t):t},t})},mutate:function(e){return e.type!==`add`&&(e.trans._cache=null),r.mutate(e)}})}}}};function Rr(e,t){return e.trans.mode===`readonly`&&!!e.subscr&&!e.trans.explicit&&e.trans.db._options.cache!==`disabled`&&!t.schema.primaryKey.outbound}function zr(e,t){switch(e){case`query`:return t.values&&!t.unique;case`get`:return!1;case`getMany`:return!1;case`count`:return!1;case`openCursor`:return!1}}var Br={stack:`dbcore`,level:0,name:`Observability`,create:function(e){var t=e.schema.name,r=new Z(e.MIN_KEY,e.MAX_KEY);return n(n({},e),{transaction:function(t,n,r){if(N.subscr&&n!==`readonly`)throw new D.ReadOnly(`Readwrite transaction in liveQuery context. Querier source: ${N.querier}`);return e.transaction(t,n,r)},table:function(i){var s=e.table(i),c=s.schema,l=c.primaryKey,u=c.indexes,d=l.extractKey,f=l.outbound,p=l.autoIncrement&&u.filter(function(e){return e.compound&&e.keyPath.includes(l.keyPath)}),m=n(n({},s),{mutate:function(n){var a=n.trans,u=n.mutatedParts||={},d=function(e){var n=`idb://${t}/${i}/${e}`;return u[n]||(u[n]=new Z)},f=d(``),m=d(`:dels`),h=n.type,g=n.type===`deleteRange`?[n.range]:n.type===`delete`?[n.keys]:n.values.length<50?[Nr(l,n).filter(function(e){return e}),n.values]:[],_=g[0],v=g[1],y=n.trans._cache;if(o(_)){f.addKeys(_);var b=h===`delete`||_.length===v.length?Ir(_,y):null;b||m.addKeys(_),(b||v)&&Vr(d,c,b,v)}else if(_){var x={from:_.lower??e.MIN_KEY,to:_.upper??e.MAX_KEY};m.add(x),f.add(x)}else f.add(r),m.add(r),c.indexes.forEach(function(e){return d(e.name).add(r)});return s.mutate(n).then(function(e){return _&&(n.type===`add`||n.type===`put`)&&(f.addKeys(e.results),p&&p.forEach(function(t){for(var r=n.values.map(function(e){return t.extractKey(e)}),i=t.keyPath.findIndex(function(e){return e===l.keyPath}),a=0,o=e.results.length;a<o;++a)r[a][i]=e.results[a];d(t.name).addKeys(r)})),a.mutatedParts=_r(a.mutatedParts||{},u),e})}}),h=function(t){var n=t.query,r=n.index,i=n.range;return[r,new Z(i.lower??e.MIN_KEY,i.upper??e.MAX_KEY)]},g={get:function(e){return[l,new Z(e.key)]},getMany:function(e){return[l,new Z().addKeys(e.keys)]},count:h,query:h,openCursor:h};return a(g).forEach(function(e){m[e]=function(a){var o=N.subscr,c=!!o,l=Rr(N,s)&&zr(e,a)?a.obsSet={}:o;if(c){var u=function(e){var n=`idb://${t}/${i}/${e}`;return l[n]||(l[n]=new Z)},p=u(``),m=u(`:dels`),h=g[e](a),_=h[0],v=h[1];if(e===`query`&&_.isPrimaryKey&&!a.values?m.add(v):u(_.name||``).add(v),!_.isPrimaryKey)if(e===`count`)m.add(r);else{var y=e===`query`&&f&&a.values&&s.query(n(n({},a),{values:!1}));return s[e].apply(this,arguments).then(function(t){if(e===`query`){if(f&&a.values)return y.then(function(e){var n=e.result;return p.addKeys(n),t});var n=a.values?t.result.map(d):t.result;a.values?p.addKeys(n):m.addKeys(n)}else if(e===`openCursor`){var r=t,i=a.values;return r&&Object.create(r,{key:{get:function(){return m.addKey(r.primaryKey),r.key}},primaryKey:{get:function(){var e=r.primaryKey;return m.addKey(e),e}},value:{get:function(){return i&&p.addKey(r.primaryKey),r.value}}})}return t})}}return s[e].apply(this,arguments)}}),m}})}};function Vr(e,t,n,r){function i(t){var i=e(t.name||``);function a(e){return e==null?null:t.extractKey(e)}var s=function(e){return t.multiEntry&&o(e)?e.forEach(function(e){return i.addKey(e)}):i.addKey(e)};(n||r).forEach(function(e,t){var i=n&&a(n[t]),o=r&&a(r[t]);K(i,o)!==0&&(i!=null&&s(i),o!=null&&s(o))})}t.indexes.forEach(i)}function Hr(e,t,r){if(r.numFailures===0)return t;if(t.type===`deleteRange`)return null;var i=t.keys?t.keys.length:`values`in t&&t.values?t.values.length:1;if(r.numFailures===i)return null;var a=n({},t);return o(a.keys)&&(a.keys=a.keys.filter(function(e,t){return!(t in r.failures)})),`values`in a&&o(a.values)&&(a.values=a.values.filter(function(e,t){return!(t in r.failures)})),a}function Ur(e,t){return t.lower===void 0?!0:t.lowerOpen?K(e,t.lower)>0:K(e,t.lower)>=0}function Wr(e,t){return t.upper===void 0?!0:t.upperOpen?K(e,t.upper)<0:K(e,t.upper)<=0}function Gr(e,t){return Ur(e,t)&&Wr(e,t)}function Kr(e,t,n,r,i,a){if(!n||n.length===0)return e;var s=t.query.index,c=s.multiEntry,l=t.query.range,u=r.schema.primaryKey.extractKey,d=s.extractKey,f=(s.lowLevelIndex||s).extractKey,p=n.reduce(function(e,n){var r=e,i=[];if(n.type===`add`||n.type===`put`)for(var a=new Z,s=n.values.length-1;s>=0;--s){var f=n.values[s],p=u(f);if(!a.hasKey(p)){var m=d(f);(c&&o(m)?m.some(function(e){return Gr(e,l)}):Gr(m,l))&&(a.addKey(p),i.push(f))}}switch(n.type){case`add`:var h=new Z().addKeys(t.values?e.map(function(e){return u(e)}):e);r=e.concat(t.values?i.filter(function(e){var t=u(e);return h.hasKey(t)?!1:(h.addKey(t),!0)}):i.map(function(e){return u(e)}).filter(function(e){return h.hasKey(e)?!1:(h.addKey(e),!0)}));break;case`put`:var g=new Z().addKeys(n.values.map(function(e){return u(e)}));r=e.filter(function(e){return!g.hasKey(t.values?u(e):e)}).concat(t.values?i:i.map(function(e){return u(e)}));break;case`delete`:var _=new Z().addKeys(n.keys);r=e.filter(function(e){return!_.hasKey(t.values?u(e):e)});break;case`deleteRange`:var v=n.range;r=e.filter(function(e){return!Gr(u(e),v)});break}return r},e);return p===e?e:(p.sort(function(e,t){return K(f(e),f(t))||K(u(e),u(t))}),t.limit&&t.limit<1/0&&(p.length>t.limit?p.length=t.limit:e.length===t.limit&&p.length<t.limit&&(i.dirty=!0)),a?Object.freeze(p):p)}function qr(e,t){return K(e.lower,t.lower)===0&&K(e.upper,t.upper)===0&&!!e.lowerOpen==!!t.lowerOpen&&!!e.upperOpen==!!t.upperOpen}function Jr(e,t,n,r){if(e===void 0)return t===void 0?0:-1;if(t===void 0)return 1;var i=K(e,t);if(i===0){if(n&&r)return 0;if(n)return 1;if(r)return-1}return i}function Yr(e,t,n,r){if(e===void 0)return t===void 0?0:1;if(t===void 0)return-1;var i=K(e,t);if(i===0){if(n&&r)return 0;if(n)return-1;if(r)return 1}return i}function Xr(e,t){return Jr(e.lower,t.lower,e.lowerOpen,t.lowerOpen)<=0&&Yr(e.upper,t.upper,e.upperOpen,t.upperOpen)>=0}function Zr(e,t,n,r){var i=yr[`idb://${e}/${t}`];if(!i)return[];var a=i.queries[n];if(!a)return[null,!1,i,null];var o=r.query?r.query.index.name:null,s=a[o||``];if(!s)return[null,!1,i,null];switch(n){case`query`:var c=s.find(function(e){return e.req.limit===r.limit&&e.req.values===r.values&&qr(e.req.query.range,r.query.range)});return c?[c,!0,i,s]:[s.find(function(e){return(`limit`in e.req?e.req.limit:1/0)>=r.limit&&(r.values?e.req.values:!0)&&Xr(e.req.query.range,r.query.range)}),!1,i,s];case`count`:var l=s.find(function(e){return qr(e.req.query.range,r.query.range)});return[l,!!l,i,s]}}function Qr(e,t,n,r){e.subscribers.add(n),r.addEventListener(`abort`,function(){e.subscribers.delete(n),e.subscribers.size===0&&$r(e,t)})}function $r(e,t){setTimeout(function(){e.subscribers.size===0&&me(t,e)},3e3)}var ei={stack:`dbcore`,level:0,name:`Cache`,create:function(e){var t=e.schema.name;return n(n({},e),{transaction:function(n,r,i){var a=e.transaction(n,r,i);if(r===`readwrite`){var o=new AbortController,s=o.signal,c=function(i){return function(){if(o.abort(),r===`readwrite`){for(var s=new Set,c=0,l=n;c<l.length;c++){var u=l[c],d=yr[`idb://${t}/${u}`];if(d){var f=e.table(u),p=d.optimisticOps.filter(function(e){return e.trans===a});if(a._explicit&&i&&a.mutatedParts)for(var m=0,h=Object.values(d.queries.query);m<h.length;m++)for(var g=h[m],_=0,v=g.slice();_<v.length;_++){var y=v[_];vr(y.obsSet,a.mutatedParts)&&(me(g,y),y.subscribers.forEach(function(e){return s.add(e)}))}else if(p.length>0){d.optimisticOps=d.optimisticOps.filter(function(e){return e.trans!==a});for(var b=0,x=Object.values(d.queries.query);b<x.length;b++)for(var g=x[b],S=0,C=g.slice();S<C.length;S++){var y=C[S];if(y.res!=null&&a.mutatedParts)if(i&&!y.dirty){var w=Object.isFrozen(y.res),ee=Kr(y.res,y.req,p,f,y,w);y.dirty?(me(g,y),y.subscribers.forEach(function(e){return s.add(e)})):ee!==y.res&&(y.res=ee,y.promise=F.resolve({result:ee}))}else y.dirty&&me(g,y),y.subscribers.forEach(function(e){return s.add(e)})}}}}s.forEach(function(e){return e()})}}};a.addEventListener(`abort`,c(!1),{signal:s}),a.addEventListener(`error`,c(!1),{signal:s}),a.addEventListener(`complete`,c(!0),{signal:s})}return a},table:function(r){var i=e.table(r),a=i.schema.primaryKey;return n(n({},i),{mutate:function(e){var o=N.trans;if(a.outbound||o.db._options.cache===`disabled`||o.explicit||o.idbtrans.mode!==`readwrite`)return i.mutate(e);var s=yr[`idb://${t}/${r}`];if(!s)return i.mutate(e);var c=i.mutate(e);return(e.type===`add`||e.type===`put`)&&(e.values.length>=50||Nr(a,e).some(function(e){return e==null}))?c.then(function(t){var r=n(n({},e),{values:e.values.map(function(e,r){if(t.failures[r])return e;var i=a.keyPath?.includes(`.`)?T(e):n({},e);return w(i,a.keyPath,t.results[r]),i})}),i=Hr(s,r,t);s.optimisticOps.push(i),queueMicrotask(function(){return e.mutatedParts&&Sr(e.mutatedParts)})}):(s.optimisticOps.push(e),e.mutatedParts&&Sr(e.mutatedParts),c.then(function(t){if(t.numFailures>0){me(s.optimisticOps,e);var n=Hr(s,e,t);n&&s.optimisticOps.push(n),e.mutatedParts&&Sr(e.mutatedParts)}}),c.catch(function(){me(s.optimisticOps,e),e.mutatedParts&&Sr(e.mutatedParts)})),c},query:function(e){if(!Rr(N,i)||!zr(`query`,e))return i.query(e);var n=N.trans?.db._options.cache===`immutable`,a=N,o=a.requery,s=a.signal,c=Zr(t,r,`query`,e),l=c[0],u=c[1],d=c[2],f=c[3];if(l&&u)l.obsSet=e.obsSet;else{var p=i.query(e).then(function(e){var t=e.result;if(l&&(l.res=t),n){for(var r=0,i=t.length;r<i;++r)Object.freeze(t[r]);Object.freeze(t)}else e.result=T(t);return e}).catch(function(e){return f&&l&&me(f,l),Promise.reject(e)});l={obsSet:e.obsSet,promise:p,subscribers:new Set,type:`query`,req:e,dirty:!1},f?f.push(l):(f=[l],d||=yr[`idb://${t}/${r}`]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}},d.queries.query[e.query.index.name||``]=f)}return Qr(l,f,o,s),l.promise.then(function(t){return{result:Kr(t.result,e,d?.optimisticOps,i,l,n)}})}})}})}};function ti(e,t){return new Proxy(e,{get:function(e,n,r){return n===`db`?t:Reflect.get(e,n,r)}})}var Q=function(){function e(t,r){var i=this;this._middlewares={},this.verno=0;var a=e.dependencies;this._options=r=n({addons:e.addons,autoOpen:!0,indexedDB:a.indexedDB,IDBKeyRange:a.IDBKeyRange,cache:`cloned`},r),this._deps={indexedDB:r.indexedDB,IDBKeyRange:r.IDBKeyRange};var o=r.addons;this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var s={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:O,dbReadyPromise:null,cancelOpen:O,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:r.autoOpen};s.dbReadyPromise=new F(function(e){s.dbReadyResolve=e}),s.openCanceller=new F(function(e,t){s.cancelOpen=t}),this._state=s,this.name=t,this.on=qt(this,`populate`,`blocked`,`versionchange`,`close`,{ready:[Ie,O]}),this.once=function(e,t){var n=function(){var r=[...arguments];i.on(e).unsubscribe(n),t.apply(i,r)};return i.on(e,n)},this.on.ready.subscribe=y(this.on.ready.subscribe,function(t){return function(n,r){e.vip(function(){var e=i._state;if(e.openComplete)e.dbOpenError||F.resolve().then(n),r&&t(n);else if(e.onReadyBeingFired)e.onReadyBeingFired.push(n),r&&t(n);else{t(n);var a=i;r||t(function e(){a.on.ready.unsubscribe(n),a.on.ready.unsubscribe(e)})}})}}),this.Collection=sn(this),this.Table=Yt(this),this.Transaction=Sn(this),this.Version=tr(this),this.WhereClause=_n(this),this.on(`versionchange`,function(e){e.newVersion>0?console.warn(`Another connection wants to upgrade database '${i.name}'. Closing db now to resume the upgrade.`):console.warn(`Another connection wants to delete database '${i.name}'. Closing db now to resume the delete request.`),i.close({disableAutoOpen:!1})}),this.on(`blocked`,function(e){!e.newVersion||e.newVersion<e.oldVersion?console.warn(`Dexie.delete('${i.name}') was blocked`):console.warn(`Upgrade '${i.name}' blocked by other connection holding version ${e.oldVersion/10}`)}),this._maxKey=Dn(r.IDBKeyRange),this._createTransaction=function(e,t,n,r){return new i.Transaction(e,t,n,i._options.chromeTransactionDurability,r)},this._fireOnBlocked=function(e){i.on(`blocked`).fire(e),Mt.filter(function(e){return e.name===i.name&&e!==i&&!e._state.vcFired}).map(function(t){return t.on(`versionchange`).fire(e)})},this.use(Lr),this.use(ei),this.use(Br),this.use(jr),this.use(Pr);var c=new Proxy(this,{get:function(e,t,n){if(t===`_vip`)return!0;if(t===`table`)return function(e){return ti(i.table(e),c)};var r=Reflect.get(e,t,n);return r instanceof Kt?ti(r,c):t===`tables`?r.map(function(e){return ti(e,c)}):t===`_createTransaction`?function(){var e=r.apply(this,arguments);return ti(e,c)}:r}});this.vip=c,o.forEach(function(e){return e(i)})}return e.prototype.version=function(e){if(isNaN(e)||e<.1)throw new D.Type(`Given version is not a positive number`);if(e=Math.round(e*10)/10,this.idbdb||this._state.isBeingOpened)throw new D.Schema(`Cannot add version when database is open`);this.verno=Math.max(this.verno,e);var t=this._versions,n=t.filter(function(t){return t._cfg.version===e})[0];return n||(n=new this.Version(e),t.push(n),t.sort(zn),n.stores({}),this._state.autoSchema=!1,n)},e.prototype._whenReady=function(e){var t=this;return this.idbdb&&(this._state.openComplete||N.letThrough||this._vip)?e():new F(function(e,n){if(t._state.openComplete)return n(new D.DatabaseClosed(t._state.dbOpenError));if(!t._state.isBeingOpened){if(!t._state.autoOpen){n(new D.DatabaseClosed);return}t.open().catch(O)}t._state.dbReadyPromise.then(e,n)}).then(e)},e.prototype.use=function(e){var t=e.stack,n=e.create,r=e.level,i=e.name;i&&this.unuse({stack:t,name:i});var a=this._middlewares[t]||(this._middlewares[t]=[]);return a.push({stack:t,create:n,level:r??10,name:i}),a.sort(function(e,t){return e.level-t.level}),this},e.prototype.unuse=function(e){var t=e.stack,n=e.name,r=e.create;return t&&this._middlewares[t]&&(this._middlewares[t]=this._middlewares[t].filter(function(e){return r?e.create!==r:n?e.name!==n:!1})),this},e.prototype.open=function(){var e=this;return V(M,function(){return Tr(e)})},e.prototype._close=function(){this.on.close.fire(new CustomEvent(`close`));var e=this._state,t=Mt.indexOf(this);if(t>=0&&Mt.splice(t,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}e.isBeingOpened||(e.dbReadyPromise=new F(function(t){e.dbReadyResolve=t}),e.openCanceller=new F(function(t,n){e.cancelOpen=n}))},e.prototype.close=function(e){var t=(e===void 0?{disableAutoOpen:!0}:e).disableAutoOpen,n=this._state;t?(n.isBeingOpened&&n.cancelOpen(new D.DatabaseClosed),this._close(),n.autoOpen=!1,n.dbOpenError=new D.DatabaseClosed):(this._close(),n.autoOpen=this._options.autoOpen||n.isBeingOpened,n.openComplete=!1,n.dbOpenError=null)},e.prototype.delete=function(e){var t=this;e===void 0&&(e={disableAutoOpen:!0});var n=arguments.length>0&&typeof arguments[0]!=`object`,r=this._state;return new F(function(i,a){var o=function(){t.close(e);var n=t._deps.indexedDB.deleteDatabase(t.name);n.onsuccess=I(function(){or(t._deps,t.name),i()}),n.onerror=Y(a),n.onblocked=t._fireOnBlocked};if(n)throw new D.InvalidArgument(`Invalid closeOptions argument to db.delete()`);r.isBeingOpened?r.dbReadyPromise.then(o):o()})},e.prototype.backendDB=function(){return this.idbdb},e.prototype.isOpen=function(){return this.idbdb!==null},e.prototype.hasBeenClosed=function(){var e=this._state.dbOpenError;return e&&e.name===`DatabaseClosed`},e.prototype.hasFailed=function(){return this._state.dbOpenError!==null},e.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(e.prototype,`tables`,{get:function(){var e=this;return a(this._allTables).map(function(t){return e._allTables[t]})},enumerable:!1,configurable:!0}),e.prototype.transaction=function(){var e=Dr.apply(this,arguments);return this._transaction.apply(this,e)},e.prototype._transaction=function(e,t,n){var r=this,i=N.trans;(!i||i.db!==this||e.indexOf(`!`)!==-1)&&(i=null);var a=e.indexOf(`?`)!==-1;e=e.replace(`!`,``).replace(`?`,``);var o,s;try{if(s=t.map(function(e){var t=e instanceof r.Table?e.name:e;if(typeof t!=`string`)throw TypeError(`Invalid table argument to Dexie.transaction(). Only Table or String are allowed`);return t}),e==`r`||e===Pt)o=Pt;else if(e==`rw`||e==Ft)o=Ft;else throw new D.InvalidArgument(`Invalid transaction mode: `+e);if(i){if(i.mode===Pt&&o===Ft)if(a)i=null;else throw new D.SubTransaction(`Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY`);i&&s.forEach(function(e){if(i&&i.storeNames.indexOf(e)===-1)if(a)i=null;else throw new D.SubTransaction(`Table `+e+` not included in parent transaction.`)}),a&&i&&!i.active&&(i=null)}}catch(e){return i?i._promise(null,function(t,n){n(e)}):H(e)}var c=Or.bind(null,this,o,s,i,n);return i?i._promise(o,c,`lock`):N.trans?V(N.transless,function(){return r._whenReady(c)}):this._whenReady(c)},e.prototype.table=function(e){if(!u(this._allTables,e))throw new D.InvalidTable(`Table ${e} does not exist`);return this._allTables[e]},e}(),ni=typeof Symbol<`u`&&`observable`in Symbol?Symbol.observable:`@@observable`,ri=function(){function e(e){this._subscribe=e}return e.prototype.subscribe=function(e,t,n){return this._subscribe(!e||typeof e==`function`?{next:e,error:t,complete:n}:e)},e.prototype[ni]=function(){return this},e}(),ii;try{ii={indexedDB:i.indexedDB||i.mozIndexedDB||i.webkitIndexedDB||i.msIndexedDB,IDBKeyRange:i.IDBKeyRange||i.webkitIDBKeyRange}}catch{ii={indexedDB:null,IDBKeyRange:null}}function ai(e){var t=!1,n,r=new ri(function(r){var i=ge(e);function a(t){var n=lt();try{i&&xt();var r=R(e,t);return i&&(r=r.finally(z)),r}finally{n&&ut()}}var o=!1,s,c={},l={},u={get closed(){return o},unsubscribe:function(){o||(o=!0,s&&s.abort(),d&&X.storagemutated.unsubscribe(m))}};r.start&&r.start(u);var d=!1,f=function(){return Dt(h)};function p(){return vr(l,c)}var m=function(e){_r(c,e),p()&&f()},h=function(){if(!(o||!ii.indexedDB)){c={};var i={};s&&s.abort(),s=new AbortController;var u={subscr:i,signal:s.signal,requery:f,querier:e,trans:null},p=a(u);Promise.resolve(p).then(function(e){t=!0,n=e,!(o||u.signal.aborted)&&(c={},l=i,!se(l)&&!d&&(X(yn,m),d=!0),Dt(function(){return!o&&r.next&&r.next(e)}))},function(e){t=!1,[`DatabaseClosedError`,`AbortError`].includes(e?.name)||o||Dt(function(){o||r.error&&r.error(e)})})}};return setTimeout(f,0),u});return r.hasValue=function(){return t},r.getValue=function(){return n},r}var oi=Q;d(oi,n(n({},ke),{delete:function(e){return new oi(e,{addons:[]}).delete()},exists:function(e){return new oi(e,{addons:[]}).open().then(function(e){return e.close(),!0}).catch(`NoSuchDatabaseError`,function(){return!1})},getDatabaseNames:function(e){try{return ir(oi.dependencies).then(e)}catch{return H(new D.MissingAPI)}},defineClass:function(){function e(e){s(this,e)}return e},ignoreTransaction:function(e){return N.trans?V(N.transless,e):e()},vip:sr,async:function(e){return function(){try{var t=Er(e.apply(this,arguments));return!t||typeof t.then!=`function`?F.resolve(t):t}catch(e){return H(e)}}},spawn:function(e,t,n){try{var r=Er(e.apply(n,t||[]));return!r||typeof r.then!=`function`?F.resolve(r):r}catch(e){return H(e)}},currentTransaction:{get:function(){return N.trans||null}},waitFor:function(e,t){var n=F.resolve(typeof e==`function`?oi.ignoreTransaction(e):e).timeout(t||6e4);return N.trans?N.trans.waitFor(n):n},Promise:F,debug:{get:function(){return A},set:function(e){Le(e)}},derive:m,extend:s,props:d,override:y,Events:qt,on:X,liveQuery:ai,extendObservabilitySet:_r,getByKeyPath:C,setByKeyPath:w,delByKeyPath:ee,shallowClone:te,deepClone:T,getObjectDiff:Mr,cmp:K,asap:x,minKey:At,addons:[],connections:Mt,errnames:Te,dependencies:ii,cache:yr,semVer:kt,version:kt.split(`.`).map(function(e){return parseInt(e)}).reduce(function(e,t,n){return e+t/10**(n*2)})})),oi.maxKey=Dn(oi.dependencies.IDBKeyRange),typeof dispatchEvent<`u`&&typeof addEventListener<`u`&&(X(yn,function(e){if(!$){var t=new CustomEvent(bn,{detail:e});$=!0,dispatchEvent(t),$=!1}}),addEventListener(bn,function(e){var t=e.detail;$||si(t)}));function si(e){var t=$;try{$=!0,X.storagemutated.fire(e),Cr(e,!0)}finally{$=t}}var $=!1,ci,li=function(){};typeof BroadcastChannel<`u`&&(li=function(){ci=new BroadcastChannel(bn),ci.onmessage=function(e){return e.data&&si(e.data)}},li(),typeof ci.unref==`function`&&ci.unref(),X(yn,function(e){$||ci.postMessage(e)})),typeof addEventListener<`u`&&(addEventListener(`pagehide`,function(e){if(!Q.disableBfCache&&e.persisted){A&&console.debug(`Dexie: handling persisted pagehide`),ci?.close();for(var t=0,n=Mt;t<n.length;t++)n[t].close({disableAutoOpen:!1})}}),addEventListener(`pageshow`,function(e){!Q.disableBfCache&&e.persisted&&(A&&console.debug(`Dexie: handling persisted pageshow`),li(),si({all:new Z(-1/0,[[]])}))}));function ui(e){return new Wt({add:e})}function di(e){return new Wt({remove:e})}function fi(e,t){return new Wt({replacePrefix:[e,t]})}return F.rejectionMapper=Oe,Le(A),n(Q,Object.freeze({__proto__:null,Dexie:Q,liveQuery:ai,Entity:Rt,cmp:K,PropModification:Wt,replacePrefix:fi,add:ui,remove:di,default:Q,RangeSet:Z,mergeRanges:fr,rangesOverlap:pr}),{default:Q}),Q}))}))(),1),s=Symbol.for(`Dexie`),c=globalThis[s]||(globalThis[s]=o.default);if(o.default.semVer!==c.semVer)throw Error(`Two different versions of Dexie loaded in the same app: ${o.default.semVer} and ${c.semVer}`);var{liveQuery:l,mergeRanges:u,rangesOverlap:d,RangeSet:f,cmp:p,Entity:m,PropModification:h,replacePrefix:g,add:_,remove:v,DexieYProvider:y}=c;const b=Object.freeze({APP:`app`,GRAPHS:`graphs`,COMPONENTS:`components`,CONNECTIONS:`connections`,DATASETS:`datasets`,CELLS:`cells`,SELF:`self`,PEERS:`peers`,MESSAGES:`messages`});function x(e){if(typeof e!=`object`||!e||Object.isFrozen(e))return e;let t=Object.getOwnPropertyNames(e);for(let n=0;n<t.length;n++){let r=e[t[n]];r&&typeof r==`object`&&x(r)}return Object.freeze(e)}function S(){return Math.floor(1e4+Math.random()*9e4)}var C=class{static all={};static safe={};static async init(){let{all:e,safe:t}=await this.loadTypes();this.all=e,this.safe=t}static async loadTypes(){let e={},t={},n=await a(()=>import(`./primitives-C9eIs5n2.js`),[]);for(let[r,i]of Object.entries(n)){let n=this.createType(i);e[r]=n,t[r]=n.safe}return{all:e,safe:t}}static async loadPackage(e=[]){let t={},n={},r=async e=>{try{let r=await a(()=>import(e),[]);for(let e of Object.values(r)){if(!e?.id)continue;let r=this.createType(e);t[r.id]=r,n[r.id]=r.safe}}catch(t){console.error(`Failed to load package:`,e,t)}};if(Array.isArray(e))for(let t of e)await r(t);else typeof e==`string`&&await r(e);return{all:t,safe:n}}static createType({id:e,name:t,description:n=``,emits:r,activate:i,tags:a=[],settings:o=[],shape:s=``,hooks:c={}}){let l={id:e,name:t,description:n,tags:[`Fnet`,`Core`,...a],emits:r,activate:i,hooks:c,shape:s,settings:o},u={...l,activate:void 0,hooks:void 0};return l.safe=x(u),x(l)}static get(e,t=!1){return t?this.safe[e]:this.all[e]}static resolve(e,t=!1){return this.get(e.component?.typeId||e.typeId,t)}static search(e){let t=e.toLowerCase();return Object.values(this.safe).filter(e=>e.name.toLowerCase().includes(t)).map(e=>({id:e.id,type:`primitive`,name:e.name,description:e.description||``}))}static async callHook(e,t,n){let r=e.hooks?.[t];typeof r==`function`&&await Promise.resolve(r({type:e,...n}))}static async beforeAdd(e){let t=this.resolve(e);await this.callHook(t,`onBeforeAdd`,e)}static async afterAdd(e){let t=this.resolve(e);await this.callHook(t,`onAfterAdd`,e)}static async afterLoad(e){let t=this.resolve(e);await this.callHook(t,`onAfterLoad`,e)}static async beforeUpdateSetting(e){let t=this.resolve(e);await this.callHook(t,`onBeforeUpdateSetting`,e)}static async afterUpdateSetting(e){let t=this.resolve(e);await this.callHook(t,`onAfterUpdateSetting`,e)}static async beforeRemove(e){let t=this.resolve(e);await this.callHook(t,`onBeforeRemove`,e)}static async afterRemove(e){let t=this.resolve(e);await this.callHook(t,`onAfterRemove`,e)}},w=class{static async getById(e,{db:t}){return await t.getById(b.COMPONENTS,e)}static async getByParent(e,{db:t}){return await t.where(b.COMPONENTS,`parentId`,e)}static async afterLoad({component:e,parent:t,manager:n}){let r=C.get(e.typeId);e.settings=r.settings?[...r.settings]:[],e.shape=r.shape,e.typeName=r.name,await C.afterLoad({component:e,parent:t,manager:n})}static async add({typeId:e,parentId:t,order:n,layer:r,values:i={}},a){let o={typeId:e,parentId:t,order:n,layer:r,values:i,createdAt:Date.now(),updatedAt:Date.now()},s=C.get(e);return await C.beforeAdd({component:o,manager:a}),o.id=await a.db.add(b.COMPONENTS,o),o.typeName=s.name,o.settings=s.settings,o.shape=s.shape,await C.afterAdd({component:o,manager:a}),a.engine.addComponent(t,o),o}static async remove(e,t){await C.beforeRemove({component:e,manager:t}),await t.db.delete(b.COMPONENTS,e.id),await C.afterRemove({component:e,manager:t})}static async update(e,t,{db:n}){await n.update(b.COMPONENTS,e,{...t,updatedAt:Date.now()})}static populate(e){let t=e.typeId,n=C.get(t,!0);e.typeName=n.name,e.shape=n.shape,e.settings=[...n.settings]}static async updateSetting({id:e,settingId:t,value:n},r){let i=await this.getById(e,r);if(!i)return null;this.populate(i);let a=i.values,o=a[t];return n===o?null:(await C.beforeUpdateSetting({component:i,settingId:t,oldValue:o,value:n,manager:r}),a[t]=n,await this.update(e,{values:a},r),await C.afterUpdateSetting({component:i,settingId:t,oldValue:o,value:n,manager:r}),i)}},ee=class{static async getByParent(e,{db:t}){return await t.where(b.CONNECTIONS,`parentId`,e)}static async add({parentId:e,fromComponentId:t,fromGateId:n,toComponentId:r,toGateId:i},{db:a}){let o={parentId:e,fromComponentId:t,fromGateId:n,toComponentId:r,toGateId:i,createdAt:Date.now(),updatedAt:Date.now()};return o.id=await a.add(b.CONNECTIONS,o),o}static async remove(e,{db:t}){await t.delete(b.CONNECTIONS,e)}static async removeByComponent(e,{db:t}){let n=[];return await t.query(b.CONNECTIONS,async t=>{let r=await t.filter(t=>t.fromComponentId===e||t.toComponentId===e).toArray();for(let e of r)await t.delete(e.id),n.push(e.id)}),n}},te=class{#id;#data;#components;#connections;#inMap;#outMap;#inCompMap;#outCompMap;#outGateMap;constructor(e){this.reset(e,e.components,e.connections)}get id(){return this.#id}reset(e,t=[],n=[]){this.#id=e.id,this.#data=e,this.#components=new Map,this.#connections=new Map,this.#inMap=new Map,this.#outMap=new Map,this.#inCompMap=new Map,this.#outCompMap=new Map,this.#outGateMap=new Map;for(let e of t)this.addComponent(e);for(let e of n)this.addConnection(e)}get components(){return this.#components.values()}get connections(){return this.#connections.values()}addComponent(e){let t=e.id;this.#components.has(t)||(this.#components.set(t,e),this.#inMap.set(t,new Set),this.#outMap.set(t,new Set),this.#inCompMap.set(t,new Set),this.#outCompMap.set(t,new Set))}removeComponent(e){if(!this.#components.has(e))return;let t=this.#inMap.get(e),n=this.#outMap.get(e);if(t)for(let e of t)this.removeConnection(e.id,!0);if(n)for(let e of n)this.removeConnection(e.id,!0);this.#inMap.delete(e),this.#outMap.delete(e),this.#inCompMap.delete(e),this.#outCompMap.delete(e),this.#components.delete(e)}updateComponent(e,t,n){let r=this.#components.get(e);r.values[t]=n}addConnection(e){let{id:t,fromComponentId:n,fromGateId:r,toComponentId:i}=e;if(!n||!i||!this.#components.has(n)||!this.#components.has(i)||this.#connections.has(t))return;this.#connections.set(t,e),this.#outMap.get(n).add(e),this.#inMap.get(i).add(e),this.#outCompMap.get(n).add(i),this.#inCompMap.get(i).add(n);let a=this.#outGateMap.get(n);a||(a=new Map,this.#outGateMap.set(n,a));let o=a.get(r);o||(o=new Set,a.set(r,o)),o.add(e)}removeConnection(e){let t=this.#connections.get(e);if(!t)return;let{fromComponentId:n,fromGateId:r,toComponentId:i}=t;this.#connections.delete(e),this.#outMap.get(n)?.delete(t),this.#inMap.get(i)?.delete(t),this.#outCompMap.get(n)?.delete(i),this.#inCompMap.get(i)?.delete(n);let a=this.#outGateMap.get(n);if(a){let e=a.get(r);e&&(e.delete(t),e.size===0&&a.delete(r)),a.size===0&&this.#outGateMap.delete(n)}}getOutComponents(e){return this.#outCompMap.get(e)}getInComponents(e){return this.#inCompMap.get(e)}forEachComponent(e){for(let t of this.#components.values())e(t)}getComponent(e){return this.#components.get(e)??null}getConnection(e){return this.#connections.get(e)??null}getOutEdges(e){return this.#outMap.get(e)}getInEdges(e){return this.#inMap.get(e)}getOutEdgesByGate(e,t){return this.#outGateMap.get(e)?.get(t)??new Set}toJSON(){return{id:this.id,...this.#data,components:Array.from(this.#components.values()).map(e=>({id:e.id,typeId:e.typeId,typeName:e.typeName,shape:e.shape,name:e.name,order:e.order,layer:e.layer,values:structuredClone(e.values??{}),settings:structuredClone(e.settings??[])})),connections:Array.from(this.#connections.values()).map(e=>({id:e.id,fromComponentId:e.fromComponentId,fromGateId:e.fromGateId,toComponentId:e.toComponentId,toGateId:e.toGateId}))}}[Symbol.structuredClone](){return this.toJSON()}static async create({name:e=`Graph-`+S(),description:t=``,tags:n=[]},{db:r}){let i={name:e,description:t,tags:n,createdAt:Date.now(),updatedAt:Date.now()};return{id:await r.add(b.GRAPHS,i),...i}}static async getById(e,{db:t}){return await t.getById(b.GRAPHS,e)}static async load(e,t){let n=await this.getById(e,t);if(!n)throw Error(`Graph definition not found`);let r=await w.getByParent(e,t),i=await ee.getByParent(e,t);n.components=r,n.connections=i;for(let e of n.components)await w.afterLoad({component:e,graph:n,manager:t});return n}static async update(e,t,{db:n}){await n.update(b.GRAPHS,e,t)}static async delete(e,{db:t}){await t.delete(b.GRAPHS,e)}static async search(e,t){return await t.db.query(b.GRAPHS,async t=>(await t.toArray()).filter(t=>t.name?.toLowerCase().includes(e)).map(e=>({id:e.id,type:`graph`,name:e.name,description:e.description||``})))}static async getByTags(e,{db:t}){return e.length===0?t.getAll(b.GRAPHS):t.query(b.GRAPHS,t=>t.where(`tags`).anyOf(e).toArray())}static async collectTags({db:e}){let t=new Set,n=await e.getAll(b.GRAPHS);for(let e of n)if(Array.isArray(e.tags))for(let n of e.tags)typeof n==`string`&&n.trim()&&t.add(n.toLowerCase());return Array.from(t).sort()}static getGraphIO(e){let t=[],n=[],r=[];if(!e)return{inputs:t,outputs:n,signals:r};let i=new Map,a=new Map;for(let t of e.connections??[])i.has(t.toComponentId)||i.set(t.toComponentId,[]),i.get(t.toComponentId).push(t),a.has(t.fromComponentId)||a.set(t.fromComponentId,[]),a.get(t.fromComponentId).push(t);for(let o of e.components??[]){let e=i.has(o.id),s=a.get(o.id)??[],c=(o.tags??[]).map(e=>e.toLowerCase());for(let i of o.settings??[]){let a=`${o.id}-${i.id}`;o.typeId===`input`&&i.role===`input`&&!e&&i.type!==`signal`?t.push({componentId:o.id,id:i.id,key:a,name:o.values?.name||i.id,type:i.type,default:o.values?.[i.id]}):o.typeId===`output`&&i.role===`output`&&i.type!==`signal`?s.some(e=>e.fromGateId===i.id)||n.push({componentId:o.id,id:i.id,key:a,name:o.values?.name||i.id,type:i.type}):i.type===`signal`&&c.includes(`interactive`)&&r.push({componentId:o.id,id:i.id,key:a})}}return{inputs:t,outputs:n,signals:r}}};Object.freeze({TABLE:`table`,DEFINITION:`definition`});const ne=Object.freeze({EMPTY:`empty`,GRAPH:`graph`,INPUT:`input`,OUTPUT:`output`,PIPE:`pipe`,DATASET:`dataset`}),re=`https://www.onclick.com.tr/peers/connect`;export{b as a,w as i,ne as n,a as o,te as r,re as t};